# 综合打分文件逐行解释文档

## 📖 文档说明
本文档对综合打分JSON文件的每一行进行详细解释，包括字段名称、中文翻译、数据类型、用途说明和UI映射关系。

---

## 🔤 第一部分：元数据字段

### 第1行：`generation_time`
- **中文名称**：生成时间
- **数据类型**：ISO 8601格式字符串
- **示例值**：`"2025-09-13T15:30:00.000000"`
- **用途说明**：记录综合打分文件的生成时刻，用于追踪数据版本
- **UI映射**：可在UI页面底部显示"数据更新时间"
- **重要程度**：中等
- **验证规则**：必须是有效的ISO时间格式

### 第2行：`scoring_version`
- **中文名称**：打分版本号
- **数据类型**：字符串
- **示例值**：`"3.0"`
- **用途说明**：标识综合打分系统的版本，用于兼容性检查
- **UI映射**：可在设置页面显示系统版本
- **重要程度**：低
- **验证规则**：格式为主版本号.次版本号

### 第3行：`scoring_standard`
- **中文名称**：打分标准
- **数据类型**：字符串
- **示例值**：`"0000-颜色和级别打分标准"`
- **用途说明**：引用的统一打分标准文档名称
- **UI映射**：鼠标悬停在热力图时显示采用的标准
- **重要程度**：高
- **验证规则**：必须引用有效的标准文档

---

## 🔑 第二部分：五个关键内容

### 关键内容1：`table_names`
- **中文名称**：表格名称列表
- **数据类型**：字符串数组
- **示例值**：
```json
[
  "小红书内容审核记录表",
  "企业风险评估矩阵表",
  "财务月度报表汇总表"
]
```
- **用途说明**：定义所有需要监控的表格名称
- **UI映射**：
  - 热力图Y轴（左侧）的行标签
  - 表格选择下拉框的选项
  - 导航菜单的表格列表
- **重要程度**：核心（必需）
- **验证规则**：
  - 必须是非空数组
  - 每个元素必须是非空字符串
  - 数组长度应与table_scores一致

### 关键内容2：`column_avg_scores`
- **中文名称**：列平均加权打分
- **数据类型**：对象（19个键值对）
- **详细字段解释**：

#### `"序号": 0.85`
- **列名**：序号
- **列级别**：L1（核心关键列）
- **平均分值**：0.85
- **风险等级**：极高风险（红色）
- **UI表现**：热力图顶部显示该列整体风险为红色警告
- **业务含义**：序号变更意味着数据结构重大调整

#### `"项目类型": 0.92`
- **列名**：项目类型
- **列级别**：L1（核心关键列）
- **平均分值**：0.92
- **风险等级**：极高风险（深红色）
- **UI表现**：热力图该列显示最高警戒级别
- **业务含义**：项目类型变更影响整个业务流程

#### `"来源": 0.25`
- **列名**：来源
- **列级别**：L3（一般信息列）
- **平均分值**：0.25
- **风险等级**：低风险（绿色）
- **UI表现**：热力图该列显示安全的绿色
- **业务含义**：来源信息变更影响较小

#### `"任务发起时间": 0.28`
- **列名**：任务发起时间
- **列级别**：L3（一般信息列）
- **平均分值**：0.28
- **风险等级**：低风险（绿色）
- **UI表现**：热力图该列显示浅绿色
- **业务含义**：时间记录的调整，风险可控

#### `"目标对齐": 0.88`
- **列名**：目标对齐
- **列级别**：L1（核心关键列）
- **平均分值**：0.88
- **风险等级**：极高风险（红色）
- **UI表现**：热力图该列显示红色警告
- **业务含义**：战略目标调整，需要高层审批

#### `"关键KR对齐": 0.91`
- **列名**：关键KR对齐
- **列级别**：L1（核心关键列）
- **平均分值**：0.91
- **风险等级**：极高风险（深红色）
- **UI表现**：热力图该列显示深红色
- **业务含义**：OKR核心指标变更，影响绩效考核

#### `"具体计划内容": 0.22`
- **列名**：具体计划内容
- **列级别**：L3（一般信息列）
- **平均分值**：0.22
- **风险等级**：低风险（绿色）
- **UI表现**：热力图该列显示绿色
- **业务含义**：计划描述文本的修改

#### `"邓总指导登记": 0.27`
- **列名**：邓总指导登记
- **列级别**：L3（一般信息列）
- **平均分值**：0.27
- **风险等级**：低风险（绿色）
- **UI表现**：热力图该列显示绿色
- **业务含义**：领导批示记录的更新

#### `"负责人": 0.55`
- **列名**：负责人
- **列级别**：L2（重要业务列）
- **平均分值**：0.55
- **风险等级**：中风险（黄色）
- **UI表现**：热力图该列显示黄色警示
- **业务含义**：负责人变更需要AI评估影响
- **特殊处理**：需要AI智能分析变更合理性

#### `"协助人": 0.58`
- **列名**：协助人
- **列级别**：L2（重要业务列）
- **平均分值**：0.58
- **风险等级**：中风险（黄色）
- **UI表现**：热力图该列显示黄橙色
- **业务含义**：团队成员调整，影响协作

#### `"监督人": 0.59`
- **列名**：监督人
- **列级别**：L2（重要业务列）
- **平均分值**：0.59
- **风险等级**：中风险（接近橙色）
- **UI表现**：热力图该列显示深黄色
- **业务含义**：监督链条变更，影响管理流程

#### `"重要程度": 0.56`
- **列名**：重要程度
- **列级别**：L2（重要业务列）
- **平均分值**：0.56
- **风险等级**：中风险（黄色）
- **UI表现**：热力图该列显示黄色
- **业务含义**：优先级调整，影响资源分配

#### `"预计完成时间": 0.54`
- **列名**：预计完成时间
- **列级别**：L2（重要业务列）
- **平均分值**：0.54
- **风险等级**：中风险（黄色）
- **UI表现**：热力图该列显示黄色
- **业务含义**：交付时间承诺变更

#### `"完成进度": 0.53`
- **列名**：完成进度
- **列级别**：L2（重要业务列）
- **平均分值**：0.53
- **风险等级**：中风险（黄色）
- **UI表现**：热力图该列显示黄色
- **业务含义**：项目执行状态更新

#### `"形成计划清单": 0.28`
- **列名**：形成计划清单
- **列级别**：L3（一般信息列）
- **平均分值**：0.28
- **风险等级**：低风险（绿色）
- **UI表现**：热力图该列显示绿色
- **业务含义**：过程文档的记录

#### `"复盘时间": 0.24`
- **列名**：复盘时间
- **列级别**：L3（一般信息列）
- **平均分值**：0.24
- **风险等级**：低风险（绿色）
- **UI表现**：热力图该列显示绿色
- **业务含义**：复盘会议时间调整

#### `"对上汇报": 0.25`
- **列名**：对上汇报
- **列级别**：L3（一般信息列）
- **平均分值**：0.25
- **风险等级**：低风险（绿色）
- **UI表现**：热力图该列显示绿色
- **业务含义**：汇报记录的更新

#### `"应用情况": 0.22`
- **列名**：应用情况
- **列级别**：L3（一般信息列）
- **平均分值**：0.22
- **风险等级**：低风险（绿色）
- **UI表现**：热力图该列显示绿色
- **业务含义**：实施效果的记录

#### `"进度分析总结": 0.23`
- **列名**：进度分析总结
- **列级别**：L3（一般信息列）
- **平均分值**：0.23
- **风险等级**：低风险（绿色）
- **UI表现**：热力图该列显示绿色
- **业务含义**：文本总结内容的修改

---

## 📊 第三部分：表格详细数据

### 关键内容3&4：`table_scores`
- **中文名称**：表格评分详情
- **数据类型**：对象数组
- **用途说明**：包含每个表格的详细修改信息和风险评分
- **UI映射**：热力图矩阵的核心数据源

#### 表格对象结构解释：

##### `table_id: 0`
- **字段名**：表格ID
- **数据类型**：整数
- **用途**：表格的唯一标识符，从0开始递增
- **UI映射**：用于数组索引定位

##### `table_name: "小红书内容审核记录表"`
- **字段名**：表格名称
- **数据类型**：字符串
- **用途**：表格的业务名称
- **UI映射**：热力图Y轴标签，鼠标悬停时显示

##### `table_url: "https://docs.qq.com/sheet/DWEFNU25TemFnZXJN"`
- **字段名**：表格URL（关键内容4）
- **数据类型**：字符串（URL格式）
- **用途**：腾讯文档的实际访问地址
- **UI映射**：点击表格名称时跳转的目标地址
- **验证规则**：必须是有效的腾讯文档URL

##### `total_rows: 92`
- **字段名**：总行数
- **数据类型**：整数
- **用途**：CSV文件的实际数据行数
- **UI映射**：悬停详情中显示"共92行数据"

##### `total_modifications: 15`
- **字段名**：总修改数
- **数据类型**：整数
- **用途**：该表格所有修改的总计
- **UI映射**：
  - 右侧横条图显示的数字
  - 表格名称旁边的修改计数

##### `overall_risk_score: 0.65`
- **字段名**：整体风险评分
- **数据类型**：浮点数（0-1）
- **用途**：表格级别的综合风险值
- **UI映射**：可用于表格排序或筛选

##### `column_scores` 对象解释：

###### 示例：`"项目类型"` 列的详细数据
```json
{
  "column_level": "L1",
  "avg_score": 0.98,
  "modified_rows": [5, 12, 28],
  "row_scores": [0.95, 0.99, 1.0],
  "modifications": 3,
  "ai_decisions": ["REVIEW", "REVIEW", "REJECT"]
}
```

- **`column_level: "L1"`**
  - 中文：列级别
  - 含义：该列的风险等级分类
  - 取值：L1（核心）、L2（重要）、L3（一般）
  - UI映射：决定最低打分阈值

- **`avg_score: 0.98`**
  - 中文：平均分数
  - 含义：该列所有修改的平均风险值
  - UI映射：决定热力图单元格的颜色
  - 颜色计算：0.98 → 红色（≥0.8）

- **`modified_rows: [5, 12, 28]`**（关键内容3的一部分）
  - 中文：修改行号列表
  - 含义：具体哪些行发生了修改
  - UI映射：
    - 悬停时显示"第5、12、28行被修改"
    - 用于生成详细修改报告

- **`row_scores: [0.95, 0.99, 1.0]`**（关键内容3的一部分）
  - 中文：行打分列表
  - 含义：每个修改行的风险评分
  - UI映射：
    - 与modified_rows一一对应
    - 悬停详情中显示每行的风险等级

- **`modifications: 3`**
  - 中文：修改次数
  - 含义：该列的修改总数
  - UI映射：右侧分布图显示"3改"

- **`ai_decisions: ["REVIEW", "REVIEW", "REJECT"]`**（仅L2列有）
  - 中文：AI决策建议
  - 含义：AI对每个修改的审批建议
  - 取值：
    - APPROVE（批准）
    - REVIEW（需审查）
    - REJECT（拒绝）
  - UI映射：悬停时显示AI建议图标

- **`ai_confidence: [0.85, 0.82, 0.73]`**（仅L2列有）
  - 中文：AI置信度
  - 含义：AI决策的可信程度
  - 取值范围：0-1
  - UI映射：显示为百分比，如"85%置信度"

---

## 🔢 第四部分：统计汇总

### 关键内容5：`total_modifications`
- **中文名称**：全部修改数
- **数据类型**：整数
- **示例值**：`499`
- **用途说明**：所有表格修改的总和
- **UI映射**：
  - 页面右上角的醒目数字
  - 仪表盘的核心指标
  - 标题栏显示"共499处修改"
- **计算方式**：所有table_scores中total_modifications的总和
- **验证规则**：必须等于各表格修改数之和

### `risk_summary` 对象
- **中文名称**：风险统计摘要
- **数据类型**：对象
- **用途说明**：按风险等级分类统计

#### `high_risk_count: 12`
- **中文**：高风险修改数
- **定义**：打分≥0.6的修改总数
- **UI映射**：风险分布饼图的红色部分

#### `medium_risk_count: 15`
- **中文**：中风险修改数
- **定义**：0.4≤打分<0.6的修改总数
- **UI映射**：风险分布饼图的黄色部分

#### `low_risk_count: 8`
- **中文**：低风险修改数
- **定义**：打分<0.4的修改总数
- **UI映射**：风险分布饼图的绿色部分

---

## 🎨 UI组件使用示例

### 热力图单元格渲染
```javascript
// 获取某个单元格的数据
let tableIndex = 0;  // 第一个表格
let columnName = "项目类型";  // 项目类型列

// 从综合打分数据获取
let cellData = comprehensive_data.table_scores[tableIndex]
                                .column_scores[columnName];

// 提取关键信息
let score = cellData.avg_score;  // 0.98
let color = getColorByScore(score);  // 返回 "#FF0000"（红色）
let modCount = cellData.modifications;  // 3

// 渲染单元格
cell.style.backgroundColor = color;
cell.setAttribute('data-score', score);
cell.setAttribute('data-modifications', modCount);
```

### 鼠标悬停显示详情
```javascript
onCellHover(tableIndex, columnName) {
  let table = comprehensive_data.table_scores[tableIndex];
  let column = table.column_scores[columnName];

  // 显示悬停弹窗
  showTooltip({
    表格: table.table_name,
    列名: columnName,
    列级别: column.column_level,  // "L1"
    平均风险: (column.avg_score * 100).toFixed(1) + "%",  // "98.0%"
    修改行: column.modified_rows.join(", "),  // "5, 12, 28"
    修改数: column.modifications + "处",  // "3处"
    风险等级: getRiskLevel(column.avg_score),  // "极高风险"
    AI建议: column.ai_decisions || "无需AI评估"  // L2列显示
  });
}
```

### 表格链接跳转
```javascript
onTableNameClick(tableIndex) {
  let table = comprehensive_data.table_scores[tableIndex];
  let url = table.table_url;

  // 新标签页打开腾讯文档
  window.open(url, '_blank');

  // 记录点击事件
  logEvent('table_link_clicked', {
    table_name: table.table_name,
    table_id: table.table_id,
    url: url
  });
}
```

---

## 📝 数据完整性验证示例

```javascript
function validateComprehensiveData(data) {
  // 验证五个关键内容
  if (!Array.isArray(data.table_names)) {
    throw new Error("table_names必须是数组");
  }

  if (Object.keys(data.column_avg_scores).length !== 19) {
    throw new Error("column_avg_scores必须包含19个标准列");
  }

  if (data.table_scores.length !== data.table_names.length) {
    throw new Error("table_scores数量必须与table_names一致");
  }

  // 验证每个表格都有URL
  for (let table of data.table_scores) {
    if (!table.table_url) {
      throw new Error(`表格${table.table_name}缺少URL`);
    }
  }

  if (typeof data.total_modifications !== 'number') {
    throw new Error("total_modifications必须是数字");
  }

  // 验证打分规则
  for (let table of data.table_scores) {
    for (let [colName, colData] of Object.entries(table.column_scores)) {
      // L1列打分验证
      if (colData.column_level === 'L1' && colData.avg_score < 0.8) {
        throw new Error(`L1列${colName}打分${colData.avg_score}低于0.8`);
      }
      // L2列打分验证
      if (colData.column_level === 'L2' && colData.avg_score < 0.4) {
        throw new Error(`L2列${colName}打分${colData.avg_score}低于0.4`);
      }
      // L3列打分验证
      if (colData.column_level === 'L3' && colData.avg_score <= 0.1) {
        throw new Error(`L3列${colName}打分${colData.avg_score}不大于0.1`);
      }
    }
  }

  console.log("✅ 数据验证通过");
  return true;
}
```

---

**文档版本**：1.0
**更新日期**：2025-09-13
**作者**：热力图开发组