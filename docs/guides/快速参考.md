# 腾讯文档智能监控系统 - 快速操作参考

## 🎯 完整10步流程操作

### 📁 预备工作：切换到项目目录
```bash
cd /root/projects/tencent-doc-manager/测试版本-性能优化开发-20250811-001430
```

---

### 步骤1️⃣: 基线设定 - 保留原版表格
```bash
# 确保有原版基线文件（如果没有，先下载原版）
python3 tencent_csv_playwright.py "原版文档URL" -o "test_original.csv"
```
**输出**: `test_original.csv` - 作为对比基准

---

### 步骤2️⃣: 获取变更 - 下载修改版表格
```bash
# 下载修改后的表格
python3 tencent_csv_playwright.py "修改版文档URL" -o "test_modified.csv"

# 私有文档需要Cookie认证
python3 tencent_csv_playwright.py "URL" -c "cookie1=value1; cookie2=value2" -o "test_modified.csv"
```
**输出**: `test_modified.csv` - 变更版本数据

---

### 步骤3️⃣: 初步对比 - CSV格式变更检测
```bash
# 执行对比分析，生成变更参数
python3 document_change_analyzer.py
```
**输出**: 变更位置、内容、实际列名列表参数

---

### 步骤4️⃣: AI列名标准化 - Claude智能匹配19个标准列
```bash
# 启动Claude AI服务（如果未启动）
python3 claude_wrapper_integration.py

# 检查AI服务状态
curl http://localhost:8081/health
```
**输出**: 一对一列名映射关系
**端口**: 8081

---

### 步骤5️⃣: 数据清洗打分 - 重新计算修改分数
```bash
# 执行AI语义分析和权重计算
python3 ai_semantic_analysis_engine.py
```
**输出**: L1/L2/L3风险等级评分

---

### 步骤6️⃣: UI参数生成 - 5200+参数处理
```bash
# 生成热力图UI数据参数
python3 -c "
import json
# UI参数自动生成（集成在热力图服务中）
print('UI参数已准备完成')
"
```
**输出**: 30×19矩阵数据，5200+可视化参数

---

### 步骤7️⃣: 热力图显示 - 科学可视化界面
```bash
# 启动热力图UI服务
python3 final_heatmap_server.py

# 访问可视化界面
echo "访问: http://localhost:8089"
```
**输出**: 高斯平滑+科学色彩热力图
**端口**: 8089

---

### 步骤8️⃣: Excel半填充 - lightUp纹理专业标记
```bash
# 生成专业半填充Excel文件
python3 excel_half_fill_processor.py

# 检查生成的文件
ls -la uploads/half_filled_result_*.xlsx
```
**输出**: 带lightUp纹理和AI批注的Excel文件

---

### 步骤9️⃣: 上传文档 - 腾讯文档平台集成
```bash
# 上传半填充Excel到腾讯文档（需要配置API）
python3 tencent_cloud_upload_strategy.py
```
**输出**: 腾讯文档查看链接

---

### 步骤🔟: UI链接绑定 - 完整用户体验
```bash
# UI中的下载链接已自动绑定
echo "热力图界面中可直接下载Excel文件"
echo "访问: http://localhost:8089 查看完整结果"
```
**输出**: 完整的用户交互体验

---

## 🚀 一键启动所有服务
```bash
# 并行启动所有必需服务
python3 claude_wrapper_integration.py &
python3 final_heatmap_server.py &

# 检查服务状态
curl http://localhost:8081/health  # Claude AI服务
curl http://localhost:8089         # 热力图UI服务
```

## 📋 快速检查命令
```bash
# 检查关键文件是否存在
ls -la test_original.csv test_modified.csv
ls -la uploads/half_filled_result_*.xlsx

# 检查服务运行状态
ps aux | grep python3

# 检查端口占用
netstat -tlnp | grep -E "8081|8089"
```

## 🔧 程序文件位置
- **下载工具**: `tencent_csv_playwright.py`
- **对比分析**: `document_change_analyzer.py`
- **AI服务**: `claude_wrapper_integration.py` (端口8081)
- **热力图UI**: `final_heatmap_server.py` (端口8089)
- **Excel处理**: `excel_half_fill_processor.py`
- **配置文档**: `CLAUDE.md`

## 📂 输出文件位置
- **基线数据**: `test_original.csv`
- **变更数据**: `test_modified.csv`
- **Excel结果**: `uploads/half_filled_result_*.xlsx`
- **可视化**: http://localhost:8089

## 🤖 下一个AI使用指南
1. 按照步骤1-10顺序执行
2. 确保每步输出文件正确生成
3. 检查服务端口8081和8089正常运行
4. 最终在8089端口查看热力图结果