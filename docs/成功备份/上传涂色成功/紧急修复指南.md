# ğŸš¨ ç´§æ€¥ä¿®å¤æŒ‡å— - æ¶‚è‰²ä¸Šä¼ é—®é¢˜

## ğŸ”¥ 30ç§’å¿«é€Ÿä¿®å¤

å¦‚æœç”¨æˆ·è¯´"æ¶‚è‰²ä¸æ˜¾ç¤º"æˆ–"ä¸Šä¼ å¤±è´¥"ï¼š

```bash
# ç«‹å³æ‰§è¡Œè¿™ä¸ªå‘½ä»¤
python3 -c "
import asyncio
from production.core_modules.tencent_doc_upload_production_v3 import quick_upload_v3
import json

with open('/root/projects/tencent-doc-manager/config/cookies.json') as f:
    cookie_string = json.load(f).get('current_cookies', '')

excel_file = input('è¾“å…¥Excelæ–‡ä»¶è·¯å¾„: ')

result = asyncio.run(quick_upload_v3(cookie_string, excel_file, True))
print(f'ç»“æœ: {result}')
"
```

---

## ğŸ” 1åˆ†é’Ÿè¯Šæ–­æµç¨‹

### æ­¥éª¤1ï¼šæ£€æŸ¥é¢œè‰²é…ç½®
```bash
grep -n "FF6666\|FFB366\|66FF66" /root/projects/tencent-doc-manager/intelligent_excel_marker.py
```
**åº”è¯¥çœ‹åˆ°**ï¼šè¿™äº›æ·±è‰²å€¼
**å¦‚æœæ²¡æœ‰**ï¼šé¢œè‰²å¤ªæµ…ï¼Œéœ€è¦ä¿®æ”¹

### æ­¥éª¤2ï¼šæ£€æŸ¥Cookieå¹´é¾„
```bash
python3 -c "
import json
from datetime import datetime
with open('/root/projects/tencent-doc-manager/config/cookies.json') as f:
    data = json.load(f)
    update_date = datetime.fromisoformat(data['last_update'].split('.')[0].replace('T', ' '))
    age_days = (datetime.now() - update_date).days
    print(f'Cookieå¹´é¾„: {age_days}å¤©')
    if age_days > 7:
        print('âš ï¸ éœ€è¦æ›´æ–°Cookieï¼')
"
```

### æ­¥éª¤3ï¼šéªŒè¯quick_upload_v3å­˜åœ¨
```bash
grep -n "def quick_upload_v3" /root/projects/tencent-doc-manager/production/core_modules/tencent_doc_upload_production_v3.py
```
**åº”è¯¥çœ‹åˆ°**ï¼šç¬¬749è¡Œçš„å‡½æ•°å®šä¹‰
**å¦‚æœæ²¡æœ‰**ï¼šæ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼Œéœ€è¦æ¢å¤

---

## ğŸ’Š 2åˆ†é’Ÿä¿®å¤æ–¹æ¡ˆ

### é—®é¢˜1ï¼šé¢œè‰²ä¸æ˜¾ç¤º
```python
# ç«‹å³ä¿®æ”¹ intelligent_excel_marker.py ç¬¬244-248è¡Œ
self.column_level_colors = {
    "L1": "FF6666",  # å¿…é¡»æ˜¯è¿™ä¸ªå€¼
    "L2": "FFB366",  # å¿…é¡»æ˜¯è¿™ä¸ªå€¼
    "L3": "66FF66"   # å¿…é¡»æ˜¯è¿™ä¸ªå€¼
}
```

### é—®é¢˜2ï¼šä¸Šä¼ å¤±è´¥
```python
# ç¡®ä¿ä½¿ç”¨è¿™ä¸ªæ–¹æ³•
from production.core_modules.tencent_doc_upload_production_v3 import quick_upload_v3
# ä¸è¦ä½¿ç”¨upload_fileæˆ–å…¶ä»–æ–¹æ³•ï¼
```

### é—®é¢˜3ï¼šCookieè¿‡æœŸ
```bash
# éœ€è¦ç”¨æˆ·ä»æµè§ˆå™¨é‡æ–°å¯¼å‡ºCookie
# ä¿å­˜åˆ° /root/projects/tencent-doc-manager/config/cookies.json
```

---

## ğŸ“‹ å®Œæ•´æ£€æŸ¥æ¸…å•

| æ£€æŸ¥é¡¹ | å‘½ä»¤ | æœŸæœ›ç»“æœ |
|--------|------|----------|
| é¢œè‰²é…ç½® | `grep FF6666 intelligent_excel_marker.py` | æ‰¾åˆ°FF6666 |
| Cookieæœ‰æ•ˆ | æ£€æŸ¥last_update | <7å¤© |
| å‡½æ•°å­˜åœ¨ | `grep quick_upload_v3` | æ‰¾åˆ°å‡½æ•° |
| æ–‡ä»¶å­˜åœ¨ | `ls -la excelæ–‡ä»¶` | æ–‡ä»¶å­˜åœ¨ |
| æ‰“åˆ†æ•°æ® | `grep total_modifications` | >0 |

---

## ğŸ”§ æ ¸å¿ƒä»£ç ï¼ˆç›´æ¥å¤åˆ¶ä½¿ç”¨ï¼‰

### å®Œæ•´çš„æˆåŠŸä¸Šä¼ ä»£ç 
```python
#!/usr/bin/env python3
import sys
sys.path.append('/root/projects/tencent-doc-manager')
import asyncio
import json
from pathlib import Path
from production.core_modules.tencent_doc_upload_production_v3 import quick_upload_v3

async def upload():
    # è¯»å–Cookie
    with open('/root/projects/tencent-doc-manager/config/cookies.json') as f:
        cookie_string = json.load(f).get('current_cookies', '')

    # Excelæ–‡ä»¶
    excel_file = '/path/to/your/excel.xlsx'  # ä¿®æ”¹è¿™é‡Œ

    # ä¸Šä¼ ï¼ˆå”¯ä¸€æ­£ç¡®æ–¹æ³•ï¼‰
    result = await quick_upload_v3(
        cookie_string=cookie_string,
        file_path=excel_file,
        headless=True
    )

    if result and result.get('success'):
        print(f"âœ… æˆåŠŸ: {result.get('url')}")
    else:
        print(f"âŒ å¤±è´¥: {result}")

    return result

# è¿è¡Œ
asyncio.run(upload())
```

---

## âš ï¸ å¸¸è§é™·é˜±

### é™·é˜±1ï¼šä½¿ç”¨é”™è¯¯çš„ä¸Šä¼ æ–¹æ³•
```python
# âŒ é”™è¯¯
uploader.upload_file(excel_file)  # ä¼šæŠ¥"æœªæ‰¾åˆ°å¯¼å…¥æŒ‰é’®"

# âœ… æ­£ç¡®
quick_upload_v3(cookie_string, excel_file, True)
```

### é™·é˜±2ï¼šé¢œè‰²å¤ªæµ…
```python
# âŒ é”™è¯¯
"L1": "FFCCCC"  # å¤ªæµ…ï¼Œçœ‹ä¸è§

# âœ… æ­£ç¡®
"L1": "FF6666"  # æ˜æ˜¾çš„çº¢è‰²
```

### é™·é˜±3ï¼šCookieæ ¼å¼é”™è¯¯
```python
# âŒ é”™è¯¯
cookie_string.split(';')  # æ²¡æœ‰ç©ºæ ¼

# âœ… æ­£ç¡®
cookie_string.split('; ')  # æœ‰ç©ºæ ¼
```

---

## ğŸ“± è”ç³»æ–¹å¼

å¦‚æœä»¥ä¸Šéƒ½å¤±è´¥äº†ï¼š

1. æŸ¥çœ‹å®Œæ•´æ–‡æ¡£ï¼š`/docs/æˆåŠŸå¤‡ä»½/ä¸Šä¼ æ¶‚è‰²æˆåŠŸ/01-é—®é¢˜è§£å†³å®Œæ•´è®°å½•.md`
2. è¿è¡Œä¸€é”®è„šæœ¬ï¼š`python3 /docs/æˆåŠŸå¤‡ä»½/ä¸Šä¼ æ¶‚è‰²æˆåŠŸ/03-ä¸€é”®æˆåŠŸè„šæœ¬.py`
3. æŸ¥çœ‹æˆåŠŸæ¡ˆä¾‹ï¼šhttps://docs.qq.com/sheet/DWHRicFFiRXNqWUtz

---

## ğŸ¯ è®°ä½è¿™å¥è¯

**"quick_upload_v3 + FF6666 = æˆåŠŸ"**

è¿™æ˜¯ç»è¿‡2å°æ—¶è°ƒè¯•éªŒè¯çš„å”¯ä¸€æ­£ç¡®æ–¹æ³•ï¼

---

*ç´§æ€¥ä¿®å¤æŒ‡å— v1.0 - 2025-09-29*
*åŸºäºå®é™…æˆåŠŸæ¡ˆä¾‹ç¼–å†™*