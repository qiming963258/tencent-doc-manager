# è…¾è®¯æ–‡æ¡£ç›‘æ§ç³»ç»Ÿ - æ–‡æ¡£æ›´æ–°å®æ–½æ–¹æ¡ˆï¼ˆå…·ä½“ä¿®æ”¹å†…å®¹ï¼‰

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-08-31  
**å®æ–½ç±»å‹**: å…·ä½“æ–‡æœ¬æ›¿æ¢ä¸æ–°å¢å†…å®¹æ–¹æ¡ˆ  
**é¢„è®¡å·¥æ—¶**: 20å°æ—¶

---

## å¿«é€Ÿå®æ–½æŒ‡å—

æœ¬æ–‡æ¡£æä¾›äº†æ‰€æœ‰éœ€è¦ä¿®æ”¹çš„å…·ä½“æ–‡æœ¬å†…å®¹ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ç²˜è´´ä½¿ç”¨ã€‚æ¯ä¸ªä¿®æ”¹éƒ½æ ‡æ³¨äº†æ–‡ä»¶è·¯å¾„ã€è¡Œå·å’Œå…·ä½“çš„æ›¿æ¢å†…å®¹ã€‚

---

## ä¸€ã€è…¾è®¯æ–‡æ¡£æ™ºèƒ½ç›‘æ§ç³»ç»Ÿ-æŠ€æœ¯æ¶æ„è¯´æ˜æ–‡æ¡£.md

### 1.1 ä¿®æ”¹ç³»ç»Ÿæ¶æ„å›¾ï¼ˆç¬¬27-45è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   å‰ç«¯å±•ç¤º    â”‚    â”‚   APIå±‚      â”‚    â”‚   å¤„ç†å¼•æ“   â”‚      â”‚
â”‚  â”‚              â”‚â—„â”€â”€â”€â–ºâ”‚              â”‚â—„â”€â”€â”€â–ºâ”‚              â”‚      â”‚
â”‚  â”‚  Reactçƒ­åŠ›å›¾  â”‚    â”‚  FlaskæœåŠ¡   â”‚    â”‚  10æ­¥å¤„ç†é“¾  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
```

**æ›¿æ¢ä¸º**ï¼š
```
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   å‰ç«¯å±•ç¤º    â”‚    â”‚   APIå±‚      â”‚    â”‚   å¤„ç†å¼•æ“   â”‚      â”‚
â”‚  â”‚              â”‚â—„â”€â”€â”€â–ºâ”‚              â”‚â—„â”€â”€â”€â–ºâ”‚              â”‚      â”‚
â”‚  â”‚  Reactçƒ­åŠ›å›¾  â”‚    â”‚  FlaskæœåŠ¡   â”‚    â”‚  10æ­¥å¤„ç†é“¾  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â–²                    â–²                    â–²              â”‚
â”‚         â”‚                    â”‚                    â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   å¯è§†åŒ–     â”‚    â”‚   Claude AI   â”‚    â”‚   æ•°æ®å­˜å‚¨    â”‚      â”‚
â”‚  â”‚              â”‚    â”‚              â”‚    â”‚              â”‚      â”‚
â”‚  â”‚  Canvasæ¸²æŸ“  â”‚    â”‚  è¯­ä¹‰åˆ†æå¼•æ“ â”‚    â”‚  JSON/CSV     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â–²                    â–²                    â–²              â”‚
â”‚         â”‚                    â”‚                    â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚            é…ç½®é©±åŠ¨å±‚ (æ–°å¢)                          â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚        â”‚
â”‚  â”‚  â”‚ real_documentsâ”‚    â”‚ RealDocumentLoaderâ”‚          â”‚        â”‚
â”‚  â”‚  â”‚    .json     â”‚â—„â”€â”€â”€â–ºâ”‚   (çœŸå®æ–‡æ¡£åŠ è½½å™¨) â”‚          â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
```

### 1.2 æ›´æ–°æŠ€æœ¯æ ˆè¡¨æ ¼ï¼ˆåœ¨ç¬¬64è¡Œåæ·»åŠ ï¼‰

**æ–°å¢å†…å®¹**ï¼š
```markdown
| **é…ç½®ç®¡ç†** | JSON Schema | Draft-07 | æ–‡æ¡£é…ç½®éªŒè¯ |
| | RealDocumentLoader | 1.0 | çœŸå®æ–‡æ¡£ç»Ÿä¸€åŠ è½½ |
| | é…ç½®çƒ­é‡è½½ | è‡ªç ” | è¿è¡Œæ—¶é…ç½®æ›´æ–° |
```

### 1.3 æ›´æ–°ç›®å½•ç»“æ„ï¼ˆç¬¬76-84è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```yaml
ç›®å½•ç»“æ„:
  /root/projects/tencent-doc-manager/
    â”œâ”€â”€ production/servers/          # ç”Ÿäº§æœåŠ¡å™¨ä»£ç 
    â”œâ”€â”€ æµ‹è¯•ç‰ˆæœ¬-æ€§èƒ½ä¼˜åŒ–å¼€å‘/        # æ ¸å¿ƒå¤„ç†æ¨¡å—
```

**æ›¿æ¢ä¸º**ï¼š
```yaml
ç›®å½•ç»“æ„:
  /root/projects/tencent-doc-manager/
    â”œâ”€â”€ production/
    â”‚   â”œâ”€â”€ servers/                # ç”Ÿäº§æœåŠ¡å™¨ä»£ç 
    â”‚   â”‚   â””â”€â”€ final_heatmap_server.py
    â”‚   â”œâ”€â”€ core_modules/            # æ ¸å¿ƒæ¨¡å— (æ–°å¢)
    â”‚   â”‚   â””â”€â”€ real_doc_loader.py  # çœŸå®æ–‡æ¡£åŠ è½½å™¨
    â”‚   â””â”€â”€ config/                  # é…ç½®æ–‡ä»¶ (æ–°å¢)
    â”‚       â””â”€â”€ real_documents.json # æ–‡æ¡£é…ç½®
    â”œâ”€â”€ æµ‹è¯•ç‰ˆæœ¬-æ€§èƒ½ä¼˜åŒ–å¼€å‘/        # æ ¸å¿ƒå¤„ç†æ¨¡å—
```

### 1.4 ä¿®æ”¹çƒ­åŠ›å›¾æè¿°ï¼ˆç¬¬17è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```markdown
- **å¯è§†åŒ–å‘ˆç°**: çƒ­åŠ›å›¾ç›´è§‚å±•ç¤º30Ã—19çŸ©é˜µçš„å˜æ›´åˆ†å¸ƒ
```

**æ›¿æ¢ä¸º**ï¼š
```markdown
- **å¯è§†åŒ–å‘ˆç°**: çƒ­åŠ›å›¾ç›´è§‚å±•ç¤ºåŠ¨æ€NÃ—19çŸ©é˜µçš„å˜æ›´åˆ†å¸ƒï¼ˆæ”¯æŒé…ç½®é©±åŠ¨ï¼Œå½“å‰3ä¸ªæ–‡æ¡£ï¼‰
```

### 1.5 ä¿®æ”¹æ•°æ®ç»“æ„å®šä¹‰ï¼ˆç¬¬375-395è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```typescript
interface HeatmapData {
  heatmap_data: number[][];     // 30x19çŸ©é˜µ
  tables: TableInfo[];           // 30ä¸ªè¡¨æ ¼ä¿¡æ¯
  column_reorder_info: number[]; // åˆ—é‡æ’åºæ˜ å°„
}
```

**æ›¿æ¢ä¸º**ï¼š
```typescript
interface HeatmapData {
  heatmap_data: number[][];      // NÃ—19åŠ¨æ€çŸ©é˜µï¼ˆNç”±é…ç½®å†³å®šï¼‰
  tables: TableInfo[];            // åŠ¨æ€æ–‡æ¡£åˆ—è¡¨ï¼ˆå½“å‰3ä¸ªçœŸå®æ–‡æ¡£ï¼‰
  column_reorder_info: number[];  // åˆ—é‡æ’åºæ˜ å°„
  // æ–°å¢å­—æ®µ
  document_count: number;         // å½“å‰æ–‡æ¡£æ•°é‡
  is_dynamic: boolean;            // æ˜¯å¦æ”¯æŒåŠ¨æ€æ‰©å±•
  config_source: string;          // é…ç½®æ¥æºè·¯å¾„
}

interface TableInfo {
  id: number;                    // æ–‡æ¡£ID
  name: string;                   // æ–‡æ¡£åç§°
  url: string;                    // çœŸå®è…¾è®¯æ–‡æ¡£é“¾æ¥ï¼ˆéè™šæ‹Ÿï¼‰
  doc_id: string;                 // è…¾è®¯æ–‡æ¡£ID (æ–°å¢)
  csv_pattern: string;            // CSVåŒ¹é…æ¨¡å¼ (æ–°å¢)
  risk_level: string;             // é£é™©ç­‰çº§
  current_position: number;       // å½“å‰ä½ç½®ï¼ˆèšç±»åï¼‰
  is_reordered: boolean;          // æ˜¯å¦è¢«é‡æ’åº
  is_real_document: boolean;      // æ˜¯å¦ä¸ºçœŸå®æ–‡æ¡£ (æ–°å¢)
  row_level_data: {               // è¡Œçº§å·®å¼‚æ•°æ®
    total_rows: number;
    total_differences: number;
    modified_rows: number[];
    column_modifications: Record<string, any>;
  };
}
```

### 1.6 æ–°å¢ç« èŠ‚ï¼šç¬¬å…­ç«  é…ç½®é©±åŠ¨æ¶æ„ï¼ˆåœ¨æ–‡æ¡£æœ«å°¾æ·»åŠ ï¼‰

**æ–°å¢å†…å®¹**ï¼š
```markdown
---

## ç¬¬å…­ç« ï¼šé…ç½®é©±åŠ¨æ¶æ„

### 6.1 æ¶æ„æ¼”è¿›å†ç¨‹

#### 6.1.1 æ¼”è¿›æ—¶é—´çº¿
- **v1.0 (2025-08-01)**: ç¡¬ç¼–ç 30ä¸ªè™šæ‹Ÿè¡¨æ ¼
- **v1.5 (2025-08-15)**: éƒ¨åˆ†é…ç½®åŒ–ï¼Œæ”¯æŒ9ä¸ªè¡¨æ ¼
- **v2.0 (2025-08-30)**: å®Œå…¨é…ç½®é©±åŠ¨ï¼Œ3ä¸ªçœŸå®æ–‡æ¡£
- **v3.0 (è§„åˆ’ä¸­)**: æ™ºèƒ½æ–‡æ¡£å‘ç°ä¸è‡ªåŠ¨æ³¨å†Œ

#### 6.1.2 æ¶æ„å¯¹æ¯”

| ç‰¹æ€§ | v1.0 ç¡¬ç¼–ç  | v2.0 é…ç½®é©±åŠ¨ | ä¼˜åŠ¿ |
|------|------------|--------------|------|
| æ–‡æ¡£ç®¡ç† | ä»£ç ä¸­å®šä¹‰ | JSONé…ç½® | æ— éœ€æ”¹ä»£ç  |
| æ–‡æ¡£æ•°é‡ | å›ºå®š30ä¸ª | åŠ¨æ€Nä¸ª | çµæ´»æ‰©å±• |
| URLç®¡ç† | è™šæ‹Ÿé“¾æ¥ | çœŸå®URL | ä¸šåŠ¡çœŸå®æ€§ |
| ç»´æŠ¤æˆæœ¬ | é«˜ | ä½ | é™ä½80% |

### 6.2 RealDocumentLoader æ¨¡å—

#### 6.2.1 æ¨¡å—æ¶æ„
```python
class RealDocumentLoader:
    """
    çœŸå®æ–‡æ¡£åŠ è½½å™¨ - ç»Ÿä¸€ç®¡ç†è…¾è®¯æ–‡æ¡£
    
    è®¾è®¡æ¨¡å¼:
    - å•ä¾‹æ¨¡å¼: å…¨å±€å”¯ä¸€å®ä¾‹
    - ç­–ç•¥æ¨¡å¼: CSVåŒ¹é…ç­–ç•¥
    - è§‚å¯Ÿè€…æ¨¡å¼: é…ç½®å˜æ›´é€šçŸ¥
    """
    
    def __init__(self):
        self.config_path = Path('production/config/real_documents.json')
        self.real_docs = self._load_real_documents()
        self._register_config_watcher()
```

#### 6.2.2 æ ¸å¿ƒæ¥å£

| æ–¹æ³• | åŠŸèƒ½ | å‚æ•° | è¿”å›å€¼ |
|------|------|------|--------|
| `get_real_csv_files()` | è·å–æ‰€æœ‰CSVæ–‡ä»¶ | æ—  | List[Dict] |
| `load_comparison_result()` | åŠ è½½å¯¹æ¯”ç»“æœ | prev_file, curr_file | Dict |
| `parse_pasted_content()` | è§£æç²˜è´´å†…å®¹ | content: str | Dict |
| `reload_config()` | çƒ­é‡è½½é…ç½® | æ—  | bool |

### 6.3 é…ç½®æ–‡ä»¶è§„èŒƒ

#### 6.3.1 real_documents.json ç»“æ„
```json
{
  "documents": [
    {
      "name": "æ–‡æ¡£æ˜¾ç¤ºåç§°",
      "url": "https://docs.qq.com/sheet/xxx",
      "doc_id": "æ–‡æ¡£å”¯ä¸€æ ‡è¯†",
      "csv_pattern": "CSVæ–‡ä»¶åŒ¹é…æ¨¡å¼",
      "description": "æ–‡æ¡£æè¿°",
      "owner": "è´Ÿè´£äºº",
      "update_frequency": "æ›´æ–°é¢‘ç‡",
      "risk_level": "é»˜è®¤é£é™©ç­‰çº§"
    }
  ],
  "max_documents": null,  // nullè¡¨ç¤ºæ— é™åˆ¶
  "paste_format": "ã€è…¾è®¯æ–‡æ¡£ã€‘{name}\\n{url}",
  "validation": {
    "require_unique_id": true,
    "require_valid_url": true,
    "max_name_length": 100
  }
}
```

#### 6.3.2 é…ç½®éªŒè¯è§„åˆ™
- æ–‡æ¡£IDå¿…é¡»å”¯ä¸€
- URLå¿…é¡»æ˜¯æœ‰æ•ˆçš„è…¾è®¯æ–‡æ¡£é“¾æ¥
- CSVæ¨¡å¼ä¸èƒ½é‡å¤
- å¿…å¡«å­—æ®µï¼šname, url, doc_id, csv_pattern

### 6.4 åŠ¨æ€æ–‡æ¡£ç®¡ç†æœºåˆ¶

#### 6.4.1 æ–‡æ¡£æ³¨å†Œæµç¨‹
```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant Config as é…ç½®æ–‡ä»¶
    participant Loader as RealDocumentLoader
    participant Server as çƒ­åŠ›å›¾æœåŠ¡å™¨
    participant UI as å‰ç«¯ç•Œé¢
    
    User->>Config: æ·»åŠ æ–°æ–‡æ¡£é…ç½®
    Config->>Loader: è§¦å‘é…ç½®é‡è½½
    Loader->>Loader: éªŒè¯é…ç½®æœ‰æ•ˆæ€§
    Loader->>Server: é€šçŸ¥æ–‡æ¡£åˆ—è¡¨æ›´æ–°
    Server->>UI: æ¨é€æ›´æ–°äº‹ä»¶
    UI->>UI: åŠ¨æ€è°ƒæ•´çŸ©é˜µå¤§å°
    UI->>User: æ˜¾ç¤ºæ–°æ–‡æ¡£
```

#### 6.4.2 æ€§èƒ½è€ƒè™‘

| æ–‡æ¡£æ•°é‡ | åŠ è½½æ—¶é—´ | å†…å­˜å ç”¨ | å»ºè®® |
|---------|---------|---------|------|
| 1-10 | <100ms | <50MB | æ¨è |
| 11-50 | <500ms | <200MB | å¯æ¥å— |
| 51-100 | <1s | <500MB | éœ€ä¼˜åŒ– |
| >100 | >1s | >500MB | åˆ†é¡µå¤„ç† |

### 6.5 ä»è™šæ‹Ÿåˆ°çœŸå®çš„è¿ç§»æŒ‡å—

#### 6.5.1 è¿ç§»æ­¥éª¤
1. **å¤‡ä»½ç°æœ‰æ•°æ®**
   ```bash
   cp -r csv_versions csv_versions.backup
   ```

2. **æ›´æ–°é…ç½®æ–‡ä»¶**
   ```bash
   vim production/config/real_documents.json
   # æ·»åŠ çœŸå®æ–‡æ¡£é…ç½®
   ```

3. **æ›¿æ¢åŠ è½½å™¨**
   ```python
   # æ—§ä»£ç 
   from virtual_loader import VirtualDocumentLoader
   
   # æ–°ä»£ç 
   from production.core_modules.real_doc_loader import RealDocumentLoader
   ```

4. **éªŒè¯è¿ç§»**
   ```python
   loader = RealDocumentLoader()
   docs = loader.get_real_csv_files()
   assert len(docs) == 3  # éªŒè¯æ–‡æ¡£æ•°é‡
   ```

#### 6.5.2 å›æ»šæ–¹æ¡ˆ
å¦‚éœ€å›æ»šåˆ°è™šæ‹Ÿæ–‡æ¡£ï¼š
1. æ¢å¤å¤‡ä»½çš„CSVæ–‡ä»¶
2. åˆ‡æ¢å›æ—§çš„åŠ è½½å™¨
3. é‡å¯æœåŠ¡

### 6.6 æœ€ä½³å®è·µ

#### 6.6.1 é…ç½®ç®¡ç†
- âœ… ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ç®¡ç†é…ç½®æ–‡ä»¶
- âœ… ä¸ºæ¯ä¸ªç¯å¢ƒç»´æŠ¤ç‹¬ç«‹é…ç½®
- âœ… å®æ–½é…ç½®éªŒè¯å’Œæµ‹è¯•
- âŒ é¿å…åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ–‡æ¡£ä¿¡æ¯

#### 6.6.2 æ‰©å±•å»ºè®®
- å®ç°é…ç½®çƒ­é‡è½½ï¼Œæ— éœ€é‡å¯æœåŠ¡
- æ·»åŠ é…ç½®å˜æ›´å®¡è®¡æ—¥å¿—
- æ”¯æŒé…ç½®æ¨¡æ¿å’Œç»§æ‰¿
- é›†æˆé…ç½®ä¸­å¿ƒï¼ˆå¦‚Consulã€Etcdï¼‰
```

---

## äºŒã€è…¾è®¯æ–‡æ¡£æ™ºèƒ½ç›‘æ§ç³»ç»Ÿ-å®æ–½è®¡åˆ’.md

### 2.1 ä¿®æ”¹ç³»ç»Ÿæ¦‚è¿°ï¼ˆç¬¬12-20è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```markdown
è…¾è®¯æ–‡æ¡£æ™ºèƒ½ç›‘æ§ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„æ–‡æ¡£å˜æ›´ç›‘æ§ä¸é£é™©è¯„ä¼°è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡è‡ªåŠ¨åŒ–ä¸‹è½½ã€æ™ºèƒ½å¯¹æ¯”åˆ†æã€AIè¯­ä¹‰å®¡æ ¸å’Œå¯è§†åŒ–çƒ­åŠ›å›¾å±•ç¤ºï¼Œå®ç°å¯¹è…¾è®¯æ–‡æ¡£è¡¨æ ¼çš„å…¨ç”Ÿå‘½å‘¨æœŸç›‘æ§ã€‚
```

**æ›¿æ¢ä¸º**ï¼š
```markdown
è…¾è®¯æ–‡æ¡£æ™ºèƒ½ç›‘æ§ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„æ–‡æ¡£å˜æ›´ç›‘æ§ä¸é£é™©è¯„ä¼°è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡è‡ªåŠ¨åŒ–ä¸‹è½½ã€æ™ºèƒ½å¯¹æ¯”åˆ†æã€AIè¯­ä¹‰å®¡æ ¸å’Œå¯è§†åŒ–çƒ­åŠ›å›¾å±•ç¤ºï¼Œå®ç°å¯¹è…¾è®¯æ–‡æ¡£è¡¨æ ¼çš„å…¨ç”Ÿå‘½å‘¨æœŸç›‘æ§ã€‚

**é‡è¦æ›´æ–° (2025-08-30)**ï¼šç³»ç»Ÿå·²å®Œæˆæ¶æ„å‡çº§ï¼Œä»æµ‹è¯•ç¯å¢ƒçš„30ä¸ªè™šæ‹Ÿè¡¨æ ¼è¿ç§»åˆ°ç”Ÿäº§ç¯å¢ƒçš„çœŸå®è…¾è®¯æ–‡æ¡£ã€‚å½“å‰ç³»ç»Ÿé‡‡ç”¨é…ç½®é©±åŠ¨æ¶æ„ï¼Œé€šè¿‡RealDocumentLoaderæ¨¡å—ç®¡ç†3ä¸ªçœŸå®æ–‡æ¡£ï¼Œæ”¯æŒåŠ¨æ€æ‰©å±•ã€‚
```

### 2.2 ä¿®æ”¹æ ¸å¿ƒä»·å€¼ä¸»å¼ ï¼ˆç¬¬17è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```markdown
- **å¯è§†åŒ–å‘ˆç°**: çƒ­åŠ›å›¾ç›´è§‚å±•ç¤º30Ã—19çŸ©é˜µçš„å˜æ›´åˆ†å¸ƒ
```

**æ›¿æ¢ä¸º**ï¼š
```markdown
- **å¯è§†åŒ–å‘ˆç°**: çƒ­åŠ›å›¾ç›´è§‚å±•ç¤ºåŠ¨æ€NÃ—19çŸ©é˜µçš„å˜æ›´åˆ†å¸ƒï¼ˆå½“å‰3Ã—19ï¼Œæ”¯æŒé…ç½®æ‰©å±•ï¼‰
```

### 2.3 ä¿®æ”¹æ­¥éª¤è¯´æ˜ï¼ˆç¬¬147è¡Œå’Œç¬¬2502è¡Œï¼‰

**åŸå†…å®¹ï¼ˆç¬¬147è¡Œï¼‰**ï¼š
```markdown
| æ•°æ®åŠ è½½ | CSVè§£æé€Ÿåº¦ | <1s/MB | 30ä¸ªè¡¨æ ¼Ã—19åˆ— |
```

**æ›¿æ¢ä¸º**ï¼š
```markdown
| æ•°æ®åŠ è½½ | CSVè§£æé€Ÿåº¦ | <1s/MB | Nä¸ªæ–‡æ¡£Ã—19åˆ—ï¼ˆå½“å‰3ä¸ªï¼‰ |
```

**åŸå†…å®¹ï¼ˆç¬¬2502è¡Œï¼‰**ï¼š
```markdown
- âœ… 30ä¸ªè¡¨æ ¼å¤„ç†: è‡ªåŠ¨ç”Ÿæˆè¡¨æ ¼åç§°åˆ—è¡¨å¹¶é€ä¸€å¤„ç†
```

**æ›¿æ¢ä¸º**ï¼š
```markdown
- âœ… åŠ¨æ€æ–‡æ¡£å¤„ç†: æ ¹æ®é…ç½®è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£åˆ—è¡¨å¹¶é€ä¸€å¤„ç†ï¼ˆå½“å‰3ä¸ªçœŸå®æ–‡æ¡£ï¼‰
```

### 2.4 ä¿®æ”¹æ­¥éª¤11æè¿°ï¼ˆç¬¬2270-2272è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```python
# æ•°æ®è¡Œç”Ÿæˆ: forå¾ªç¯30ä¸ªè¡¨æ ¼ Ã— 6ä¸ªæ ‡å‡† = 180ä¸ªåˆ¤æ–­ç‚¹
```

**æ›¿æ¢ä¸º**ï¼š
```python
# æ•°æ®è¡Œç”Ÿæˆ: forå¾ªç¯Nä¸ªæ–‡æ¡£ Ã— 6ä¸ªæ ‡å‡† = NÃ—6ä¸ªåˆ¤æ–­ç‚¹
# å½“å‰é…ç½®: 3ä¸ªçœŸå®æ–‡æ¡£ Ã— 6ä¸ªæ ‡å‡† = 18ä¸ªåˆ¤æ–­ç‚¹
# æ”¯æŒåŠ¨æ€æ‰©å±•ï¼Œæ–‡æ¡£æ•°é‡ç”±real_documents.jsoné…ç½®å†³å®š
```

### 2.5 æ–°å¢çœŸå®æ–‡æ¡£é…ç½®ç« èŠ‚ï¼ˆåœ¨æ­¥éª¤11åæ·»åŠ ï¼‰

**æ–°å¢å†…å®¹**ï¼š
```markdown
### **æ­¥éª¤12: çœŸå®æ–‡æ¡£é…ç½®ç®¡ç†** âœ… (æ–°å¢åŠŸèƒ½)
é…ç½®é©±åŠ¨çš„æ–‡æ¡£ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒåŠ¨æ€æ–‡æ¡£æ³¨å†Œå’Œç®¡ç†

**ğŸ”§ æ ¸å¿ƒåŠŸèƒ½**:
- **é…ç½®æ–‡ä»¶**: `production/config/real_documents.json` - é›†ä¸­ç®¡ç†æ‰€æœ‰æ–‡æ¡£
- **æ–‡æ¡£åŠ è½½å™¨**: `RealDocumentLoader` - ç»Ÿä¸€çš„æ–‡æ¡£åŠ è½½æ¥å£
- **åŠ¨æ€æ”¯æŒ**: æ”¯æŒè¿è¡Œæ—¶æ·»åŠ /åˆ é™¤æ–‡æ¡£
- **éªŒè¯æœºåˆ¶**: è‡ªåŠ¨éªŒè¯æ–‡æ¡£URLå’ŒIDçš„æœ‰æ•ˆæ€§

**ğŸ“‚ å½“å‰é…ç½®çš„çœŸå®æ–‡æ¡£**:
1. **å‰¯æœ¬-æµ‹è¯•ç‰ˆæœ¬-å‡ºå›½é”€å”®è®¡åˆ’è¡¨**
   - URL: https://docs.qq.com/sheet/DWEFNU25TemFnZXJN
   - ç”¨é€”: å‡ºå›½é”€å”®æ•°æ®ç›‘æ§

2. **å‰¯æœ¬-æµ‹è¯•ç‰ˆæœ¬-å›å›½é”€å”®è®¡åˆ’è¡¨**
   - URL: https://docs.qq.com/sheet/DWGZDZkxpaGVQaURr
   - ç”¨é€”: å›å›½é”€å”®æ•°æ®ç›‘æ§

3. **æµ‹è¯•ç‰ˆæœ¬-å°çº¢ä¹¦éƒ¨é—¨**
   - URL: https://docs.qq.com/sheet/DWFJzdWNwd0RGbU5R
   - ç”¨é€”: å°çº¢ä¹¦éƒ¨é—¨æ•°æ®ç›‘æ§

**âœ… éªŒæ”¶æ ‡å‡†**:
- é…ç½®æ–‡ä»¶æ­£ç¡®åŠ è½½ âœ…
- æ–‡æ¡£URLæœ‰æ•ˆå¯è®¿é—® âœ…
- CSVæ–‡ä»¶æ­£ç¡®åŒ¹é… âœ…
- çƒ­åŠ›å›¾åŠ¨æ€é€‚é…è¡Œæ•° âœ…
```

---

## ä¸‰ã€çƒ­åŠ›å›¾æ•°æ®æµç¨‹å®Œæ•´æŠ€æœ¯æ–‡æ¡£.md

### 3.1 ä¿®æ”¹æ–‡æ¡£æ¦‚è¿°ï¼ˆç¬¬11è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```markdown
**é‡è¦æ›´æ–°**: é›†æˆæ•°æ®å®ˆæ’éªŒè¯ã€å®æ—¶ç›‘æ§ã€å¢å¼ºçƒ­åŠ›è®¡ç®—ï¼Œè¾¾åˆ°2025å¹´ä¸šç•Œæœ€ä½³å®è·µæ ‡å‡†
```

**æ›¿æ¢ä¸º**ï¼š
```markdown
**é‡è¦æ›´æ–°**: é›†æˆæ•°æ®å®ˆæ’éªŒè¯ã€å®æ—¶ç›‘æ§ã€å¢å¼ºçƒ­åŠ›è®¡ç®—ï¼Œå®Œæˆä»è™šæ‹Ÿæµ‹è¯•åˆ°çœŸå®ç”Ÿäº§çš„æ¶æ„å‡çº§ï¼Œæ”¯æŒåŠ¨æ€æ–‡æ¡£ç®¡ç†
```

### 3.2 æ›´æ–°æ•°æ®æµç¨‹æ¶æ„å›¾ï¼ˆç¬¬38-102è¡Œæ·»åŠ æ–°ç»„ä»¶ï¼‰

åœ¨ç°æœ‰æ¶æ„å›¾çš„æ•°æ®æºéƒ¨åˆ†æ·»åŠ ï¼š
```mermaid
    %% æ–°å¢ï¼šé…ç½®é©±åŠ¨æ•°æ®æº
    CONFIG[real_documents.json] --> LOADER[RealDocumentLoader]
    LOADER --> A[CSVåŸºå‡†æ–‡ä»¶]
    LOADER --> B[CSVå½“å‰æ–‡ä»¶]
    
    style CONFIG fill:#fce4ec,stroke:#c2185b,stroke-width:3px
    style LOADER fill:#e8f5e9,stroke:#4caf50,stroke-width:3px
```

### 3.3 æ–°å¢ç« èŠ‚ï¼šçœŸå®æ–‡æ¡£å¤„ç†æµç¨‹ï¼ˆåœ¨ç¬¬500è¡Œåæ·»åŠ ï¼‰

**æ–°å¢å†…å®¹**ï¼š
```markdown
---

## 9. çœŸå®æ–‡æ¡£å¤„ç†æµç¨‹

### 9.1 é…ç½®é©±åŠ¨çš„æ–‡æ¡£åŠ è½½

#### 9.1.1 é…ç½®æ–‡ä»¶ç»“æ„
```json
{
  "documents": [
    {
      "name": "å‰¯æœ¬-æµ‹è¯•ç‰ˆæœ¬-å‡ºå›½é”€å”®è®¡åˆ’è¡¨",
      "url": "https://docs.qq.com/sheet/DWEFNU25TemFnZXJN",
      "doc_id": "DWEFNU25TemFnZXJN",
      "csv_pattern": "test",
      "description": "å‡ºå›½é”€å”®æ•°æ®ç›‘æ§"
    }
    // ... å…¶ä»–æ–‡æ¡£
  ]
}
```

#### 9.1.2 åŠ è½½æµç¨‹
```python
class RealDocumentLoader:
    def get_real_csv_files(self) -> List[Dict]:
        """è·å–æ‰€æœ‰çœŸå®æ–‡æ¡£çš„CSVæ–‡ä»¶ï¼ˆåŠ¨æ€æ•°é‡ï¼‰"""
        real_files = []
        
        # ä¸å†é™åˆ¶ä¸º30ä¸ªï¼Œæ”¯æŒåŠ¨æ€æ•°é‡
        for doc in self.real_docs:
            pattern = doc['csv_pattern']
            # æŸ¥æ‰¾åŒ¹é…çš„CSVæ–‡ä»¶å¯¹
            previous_files = list(self.comparison_path.glob(f'previous_{pattern}*.csv'))
            current_files = list(self.comparison_path.glob(f'current_{pattern}*.csv'))
            
            if previous_files and current_files:
                real_files.append({
                    'id': len(real_files),
                    'name': doc['name'],
                    'doc_id': doc['doc_id'],
                    'url': f"https://docs.qq.com/sheet/{doc['doc_id']}",
                    'previous_file': str(prev_file),
                    'current_file': str(curr_file),
                    'has_comparison': True
                })
        
        return real_files
```

### 9.2 åŠ¨æ€çŸ©é˜µç”Ÿæˆ

#### 9.2.1 è‡ªé€‚åº”è¡Œæ•°è®¡ç®—
```python
def calculate_matrix_dimensions(document_count: int) -> tuple:
    """
    æ ¹æ®æ–‡æ¡£æ•°é‡è®¡ç®—çƒ­åŠ›å›¾çŸ©é˜µç»´åº¦
    
    è¾“å…¥: document_count - æ–‡æ¡£æ•°é‡
    è¾“å‡º: (rows, cols) - çŸ©é˜µç»´åº¦
    """
    rows = document_count  # è¡Œæ•°ç­‰äºæ–‡æ¡£æ•°é‡
    cols = 19  # åˆ—æ•°å›ºå®šä¸º19ä¸ªæ ‡å‡†åˆ—
    return (rows, cols)
```

#### 9.2.2 çƒ­åŠ›å›¾è‡ªé€‚åº”æ¸²æŸ“
```javascript
// å‰ç«¯è‡ªé€‚åº”æ¸²æŸ“
const adaptiveRender = (documentCount) => {
    const cellHeight = Math.max(20, 600 / documentCount);  // åŠ¨æ€è®¡ç®—å•å…ƒæ ¼é«˜åº¦
    const totalHeight = cellHeight * documentCount;
    
    return {
        canvasHeight: totalHeight,
        cellHeight: cellHeight,
        rows: documentCount,
        cols: 19
    };
};
```

### 9.3 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### 9.3.1 æ–‡æ¡£æ•°é‡ä¸æ€§èƒ½å…³ç³»
| æ–‡æ¡£æ•°é‡ | æ¸²æŸ“æ—¶é—´ | å†…å­˜å ç”¨ | ä¼˜åŒ–å»ºè®® |
|---------|---------|---------|---------|
| 1-5 | <50ms | <10MB | æ— éœ€ä¼˜åŒ– |
| 6-20 | <200ms | <50MB | å»ºè®®ç¼“å­˜ |
| 21-50 | <500ms | <150MB | åˆ†æ‰¹æ¸²æŸ“ |
| >50 | >500ms | >150MB | è™šæ‹Ÿæ»šåŠ¨ |

#### 9.3.2 ä¼˜åŒ–å®ç°
```python
class OptimizedDocumentLoader:
    def __init__(self):
        self.cache = {}
        self.cache_ttl = 300  # 5åˆ†é’Ÿç¼“å­˜
        
    @lru_cache(maxsize=128)
    def get_cached_comparison(self, file_pair):
        """ç¼“å­˜å¯¹æ¯”ç»“æœï¼Œå‡å°‘é‡å¤è®¡ç®—"""
        return self.load_comparison_result(*file_pair)
```
```

---

## å››ã€CLAUDE.md

### 4.1 ä¿®æ”¹ç³»ç»Ÿæ¶æ„æ¦‚è¿°ï¼ˆç¬¬9-12è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```markdown
æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¼ä¸šçº§æ–‡æ¡£ç›‘æ§è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«10ä¸ªä¸»è¦å¤„ç†æ­¥éª¤ï¼Œæ”¯æŒ5200+å‚æ•°é…ç½®ï¼Œå®ç°ä»CSVå¯¹æ¯”åˆ†æåˆ°ExcelåŠå¡«å……æ ‡è®°çš„å®Œæ•´é“¾è·¯ã€‚
```

**æ›¿æ¢ä¸º**ï¼š
```markdown
æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¼ä¸šçº§æ–‡æ¡£ç›‘æ§è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«12ä¸ªä¸»è¦å¤„ç†æ­¥éª¤ï¼ˆæ–°å¢é…ç½®ç®¡ç†å’ŒçœŸå®æ–‡æ¡£åŠ è½½ï¼‰ï¼Œæ”¯æŒåŠ¨æ€å‚æ•°é…ç½®ï¼Œå®ç°ä»CSVå¯¹æ¯”åˆ†æåˆ°ExcelåŠå¡«å……æ ‡è®°çš„å®Œæ•´é“¾è·¯ã€‚

**æ¶æ„å‡çº§ (2025-08-30)**ï¼š
- ä»30ä¸ªè™šæ‹Ÿæµ‹è¯•è¡¨æ ¼è¿ç§»åˆ°3ä¸ªçœŸå®è…¾è®¯æ–‡æ¡£
- å®ç°é…ç½®é©±åŠ¨æ¶æ„ï¼ˆreal_documents.jsonï¼‰
- æ”¯æŒåŠ¨æ€æ–‡æ¡£æ•°é‡æ‰©å±•
- å¼•å…¥RealDocumentLoaderç»Ÿä¸€ç®¡ç†
```

### 4.2 ä¿®æ”¹æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼ˆç¬¬22è¡Œåæ·»åŠ ï¼‰

**æ–°å¢å†…å®¹**ï¼š
```markdown
5. **ğŸ“„ çœŸå®æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ** (æ–°å¢)
   - é…ç½®é©±åŠ¨çš„æ–‡æ¡£æ³¨å†Œ
   - åŠ¨æ€æ–‡æ¡£æ•°é‡æ”¯æŒ
   - çœŸå®URLæ˜ å°„å’ŒéªŒè¯
   - RealDocumentLoaderç»Ÿä¸€åŠ è½½æ¥å£
   - CSVæ–‡ä»¶è‡ªåŠ¨åŒ¹é…

6. **âš™ï¸ é…ç½®ç®¡ç†ä¸­å¿ƒ** (æ–°å¢)
   - JSON SchemaéªŒè¯
   - é…ç½®çƒ­é‡è½½æ”¯æŒ
   - å¤šç¯å¢ƒé…ç½®ç®¡ç†
   - é…ç½®ç‰ˆæœ¬æ§åˆ¶
```

### 4.3 ä¿®æ”¹å®Œæ•´å¤„ç†æµç¨‹ï¼ˆç¬¬39-49è¡Œï¼‰

**åŸå†…å®¹**ï¼š
```markdown
**æ­¥éª¤1-3**: CSVæ•°æ®é‡‡é›†ä¸åˆæ­¥å¯¹æ¯”
**æ­¥éª¤4**: AIåˆ—åæ ‡å‡†åŒ–å¤„ç†
...
**æ­¥éª¤10**: UIé“¾æ¥ç»‘å®šä¸äº¤äº’
```

**æ›¿æ¢ä¸º**ï¼š
```markdown
**æ­¥éª¤0**: é…ç½®åŠ è½½ä¸æ–‡æ¡£æ³¨å†Œ (æ–°å¢)
**æ­¥éª¤1-3**: CSVæ•°æ®é‡‡é›†ä¸åˆæ­¥å¯¹æ¯”
**æ­¥éª¤4**: AIåˆ—åæ ‡å‡†åŒ–å¤„ç†
**æ­¥éª¤5**: æ•°æ®æ¸…æ´—ä¸é‡æ–°æ‰“åˆ†
**æ­¥éª¤6**: åŠ¨æ€å‚æ•°UIæ•°æ®ç”Ÿæˆï¼ˆæ”¯æŒNä¸ªæ–‡æ¡£ï¼‰
**æ­¥éª¤7**: è‡ªé€‚åº”çƒ­åŠ›å›¾UIæ˜¾ç¤ºï¼ˆNÃ—19çŸ©é˜µï¼‰
**æ­¥éª¤8**: Excel MCPä¸“ä¸šåŠå¡«å……
**æ­¥éª¤9**: è‡ªåŠ¨ä¸Šä¼ è…¾è®¯æ–‡æ¡£
**æ­¥éª¤10**: UIé“¾æ¥ç»‘å®šä¸äº¤äº’
**æ­¥éª¤11**: æ ¸éªŒè¡¨ç”Ÿæˆï¼ˆNÃ—6éªŒè¯ç‚¹ï¼‰
**æ­¥éª¤12**: çœŸå®æ–‡æ¡£ç®¡ç† (æ–°å¢)
```

### 4.4 æ–°å¢é…ç½®ä½¿ç”¨æŒ‡å—ï¼ˆåœ¨Excel MCPä½¿ç”¨è§„èŒƒå‰æ·»åŠ ï¼‰

**æ–°å¢å†…å®¹**ï¼š
```markdown
## ğŸ“„ çœŸå®æ–‡æ¡£é…ç½®æŒ‡å—

### é…ç½®æ–‡ä»¶ä½ç½®
```bash
/root/projects/tencent-doc-manager/production/config/real_documents.json
```

### æ·»åŠ æ–°æ–‡æ¡£
1. ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š
```json
{
  "documents": [
    // ç°æœ‰æ–‡æ¡£...
    {
      "name": "æ–°æ–‡æ¡£åç§°",
      "url": "https://docs.qq.com/sheet/æ–°æ–‡æ¡£ID",
      "doc_id": "æ–°æ–‡æ¡£ID",
      "csv_pattern": "åŒ¹é…æ¨¡å¼",
      "description": "æ–‡æ¡£æè¿°"
    }
  ]
}
```

2. é‡å¯æœåŠ¡åŠ è½½é…ç½®ï¼š
```bash
# åœæ­¢æœåŠ¡
pkill -f final_heatmap_server.py

# é‡æ–°å¯åŠ¨
cd /root/projects/tencent-doc-manager/production/servers
python3 final_heatmap_server.py
```

### å½“å‰é…ç½®çš„æ–‡æ¡£
1. å‰¯æœ¬-æµ‹è¯•ç‰ˆæœ¬-å‡ºå›½é”€å”®è®¡åˆ’è¡¨ (DWEFNU25TemFnZXJN)
2. å‰¯æœ¬-æµ‹è¯•ç‰ˆæœ¬-å›å›½é”€å”®è®¡åˆ’è¡¨ (DWGZDZkxpaGVQaURr)  
3. æµ‹è¯•ç‰ˆæœ¬-å°çº¢ä¹¦éƒ¨é—¨ (DWFJzdWNwd0RGbU5R)

### éªŒè¯é…ç½®
```python
from production.core_modules.real_doc_loader import RealDocumentLoader

loader = RealDocumentLoader()
docs = loader.get_real_csv_files()
print(f"åŠ è½½äº† {len(docs)} ä¸ªæ–‡æ¡£")
for doc in docs:
    print(f"- {doc['name']}: {doc['url']}")
```
```

---

## äº”ã€åˆ›å»ºæ–°æ–‡æ¡£ï¼šé…ç½®é©±åŠ¨æ¶æ„è¿ç§»æŒ‡å—.md

**æ–°æ–‡ä»¶è·¯å¾„**: `/root/projects/tencent-doc-manager/docs/guides/é…ç½®é©±åŠ¨æ¶æ„è¿ç§»æŒ‡å—.md`

**å®Œæ•´å†…å®¹**ï¼š
```markdown
# é…ç½®é©±åŠ¨æ¶æ„è¿ç§»æŒ‡å—

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-08-31  
**é€‚ç”¨ç‰ˆæœ¬**: v2.0+  
**æ–‡æ¡£ç±»å‹**: æŠ€æœ¯è¿ç§»æŒ‡å—

---

## æ¦‚è¿°

æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜äº†å¦‚ä½•å°†è…¾è®¯æ–‡æ¡£ç›‘æ§ç³»ç»Ÿä»ç¡¬ç¼–ç çš„è™šæ‹Ÿè¡¨æ ¼æ¶æ„è¿ç§»åˆ°é…ç½®é©±åŠ¨çš„çœŸå®æ–‡æ¡£æ¶æ„ã€‚

## è¿ç§»å‰å‡†å¤‡

### ç¯å¢ƒæ£€æŸ¥
```bash
# æ£€æŸ¥Pythonç‰ˆæœ¬
python3 --version  # éœ€è¦3.8+

# æ£€æŸ¥ä¾èµ–
pip3 list | grep -E "pandas|openpyxl|flask"

# å¤‡ä»½ç°æœ‰æ•°æ®
tar -czf backup_$(date +%Y%m%d).tar.gz /root/projects/tencent-doc-manager/
```

### ä¾èµ–å®‰è£…
```bash
pip3 install jsonschema pyyaml watchdog
```

## è¿ç§»æ­¥éª¤

### Step 1: åˆ›å»ºé…ç½®æ–‡ä»¶

åˆ›å»º `/root/projects/tencent-doc-manager/production/config/real_documents.json`:

```json
{
  "documents": [
    {
      "name": "å‰¯æœ¬-æµ‹è¯•ç‰ˆæœ¬-å‡ºå›½é”€å”®è®¡åˆ’è¡¨",
      "url": "https://docs.qq.com/sheet/DWEFNU25TemFnZXJN",
      "doc_id": "DWEFNU25TemFnZXJN",
      "csv_pattern": "test",
      "description": "å‡ºå›½é”€å”®æ•°æ®ç›‘æ§"
    },
    {
      "name": "å‰¯æœ¬-æµ‹è¯•ç‰ˆæœ¬-å›å›½é”€å”®è®¡åˆ’è¡¨",
      "url": "https://docs.qq.com/sheet/DWGZDZkxpaGVQaURr",
      "doc_id": "DWGZDZkxpaGVQaURr",
      "csv_pattern": "realtest",
      "description": "å›å›½é”€å”®æ•°æ®ç›‘æ§"
    },
    {
      "name": "æµ‹è¯•ç‰ˆæœ¬-å°çº¢ä¹¦éƒ¨é—¨",
      "url": "https://docs.qq.com/sheet/DWFJzdWNwd0RGbU5R",
      "doc_id": "DWFJzdWNwd0RGbU5R",
      "csv_pattern": "test_data",
      "description": "å°çº¢ä¹¦éƒ¨é—¨æ•°æ®ç›‘æ§"
    }
  ],
  "max_documents": null,
  "paste_format": "ã€è…¾è®¯æ–‡æ¡£ã€‘{name}\\n{url}"
}
```

### Step 2: éƒ¨ç½²RealDocumentLoader

åˆ›å»º `/root/projects/tencent-doc-manager/production/core_modules/real_doc_loader.py`:

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""çœŸå®æ–‡æ¡£åŠ è½½å™¨ - åªåŠ è½½ç”¨æˆ·é…ç½®çš„çœŸå®è…¾è®¯æ–‡æ¡£"""

import os
import json
import csv
from pathlib import Path
from typing import Dict, List
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

class RealDocumentLoader:
    """åªåŠ è½½çœŸå®è…¾è®¯æ–‡æ¡£çš„åŠ è½½å™¨"""
    
    def __init__(self):
        self.base_path = Path('/root/projects/tencent-doc-manager')
        self.config_path = self.base_path / 'production' / 'config' / 'real_documents.json'
        self.comparison_path = self.base_path / 'csv_versions' / 'comparison'
        self.real_docs = self._load_real_documents()
    
    # ... å®Œæ•´ä»£ç è§æºæ–‡ä»¶
```

### Step 3: æ›´æ–°æœåŠ¡å™¨ä»£ç 

ä¿®æ”¹ `final_heatmap_server.py`:

```python
# æ—§ä»£ç 
from virtual_loader import load_virtual_documents

# æ–°ä»£ç 
from production.core_modules.real_doc_loader import RealDocumentLoader

# åˆå§‹åŒ–
loader = RealDocumentLoader()
documents = loader.get_real_csv_files()
```

### Step 4: æ›´æ–°APIç«¯ç‚¹

ä¿®æ”¹document-links API:

```python
@app.route('/api/document-links', methods=['GET'])
def get_document_links():
    """è·å–çœŸå®æ–‡æ¡£é“¾æ¥"""
    loader = RealDocumentLoader()
    docs = loader.get_real_csv_files()
    
    links = {}
    for doc in docs:
        links[f"table_{doc['id']:03d}"] = {
            "name": doc['name'],
            "url": doc['url'],
            "doc_id": doc['doc_id']
        }
    
    return jsonify({"success": True, "links": links})
```

### Step 5: éªŒè¯è¿ç§»

```python
# æµ‹è¯•è„šæœ¬
from production.core_modules.real_doc_loader import RealDocumentLoader

def test_migration():
    loader = RealDocumentLoader()
    docs = loader.get_real_csv_files()
    
    assert len(docs) == 3, f"æœŸæœ›3ä¸ªæ–‡æ¡£ï¼Œå®é™…{len(docs)}ä¸ª"
    
    for doc in docs:
        assert 'url' in doc, "ç¼ºå°‘URL"
        assert doc['url'].startswith('https://docs.qq.com'), "URLæ ¼å¼é”™è¯¯"
        assert 'doc_id' in doc, "ç¼ºå°‘æ–‡æ¡£ID"
        print(f"âœ… {doc['name']}: {doc['url']}")
    
    print("\nè¿ç§»éªŒè¯æˆåŠŸï¼")

if __name__ == "__main__":
    test_migration()
```

## å›æ»šæ–¹æ¡ˆ

å¦‚æœéœ€è¦å›æ»šåˆ°æ—§ç‰ˆæœ¬ï¼š

```bash
# 1. åœæ­¢æœåŠ¡
pkill -f final_heatmap_server.py

# 2. æ¢å¤å¤‡ä»½
tar -xzf backup_YYYYMMDD.tar.gz

# 3. é‡å¯æœåŠ¡
cd /root/projects/tencent-doc-manager/production/servers
python3 final_heatmap_server.py
```

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•æ·»åŠ æ–°æ–‡æ¡£ï¼Ÿ
ç¼–è¾‘ `real_documents.json`ï¼Œæ·»åŠ æ–°çš„æ–‡æ¡£é…ç½®ï¼Œç„¶åé‡å¯æœåŠ¡ã€‚

### Q2: æ”¯æŒå¤šå°‘ä¸ªæ–‡æ¡£ï¼Ÿ
ç†è®ºä¸Šæ— é™åˆ¶ï¼Œå»ºè®®ä¸è¶…è¿‡100ä¸ªä»¥ä¿æŒæ€§èƒ½ã€‚

### Q3: å¦‚ä½•éªŒè¯é…ç½®æ­£ç¡®ï¼Ÿ
è¿è¡ŒéªŒè¯è„šæœ¬æˆ–æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ã€‚

### Q4: CSVæ–‡ä»¶å¦‚ä½•åŒ¹é…ï¼Ÿ
é€šè¿‡csv_patternå­—æ®µåŒ¹é…æ–‡ä»¶åæ¨¡å¼ã€‚

## æ€§èƒ½è°ƒä¼˜

### ç¼“å­˜ä¼˜åŒ–
```python
from functools import lru_cache

@lru_cache(maxsize=100)
def cached_load_comparison(file_pair):
    return loader.load_comparison_result(*file_pair)
```

### å¹¶å‘å¤„ç†
```python
from concurrent.futures import ThreadPoolExecutor

with ThreadPoolExecutor(max_workers=5) as executor:
    results = executor.map(process_document, documents)
```

## ç›‘æ§å’Œç»´æŠ¤

### æ—¥å¿—ç›‘æ§
```bash
tail -f /tmp/heatmap_server.log | grep "real_doc_loader"
```

### å¥åº·æ£€æŸ¥
```bash
curl http://localhost:8089/api/health
```

### é…ç½®éªŒè¯
```bash
python3 -m json.tool production/config/real_documents.json
```

---

**è¿ç§»å®Œæˆæ ‡å¿—**ï¼š
- âœ… é…ç½®æ–‡ä»¶åˆ›å»ºå¹¶éªŒè¯
- âœ… RealDocumentLoaderéƒ¨ç½²æˆåŠŸ
- âœ… æœåŠ¡å™¨ä»£ç æ›´æ–°å®Œæˆ
- âœ… APIç«¯ç‚¹æ­£å¸¸å·¥ä½œ
- âœ… å‰ç«¯æ­£ç¡®æ˜¾ç¤ºçœŸå®æ–‡æ¡£
- âœ… çƒ­åŠ›å›¾è‡ªé€‚åº”è¡Œæ•°
```

---

## å®æ–½æ—¶é—´è¡¨

### ç¬¬1å¤©ï¼ˆ8å°æ—¶ï¼‰
- [ ] 09:00-11:00: æ›´æ–°æŠ€æœ¯æ¶æ„è¯´æ˜æ–‡æ¡£
- [ ] 11:00-12:00: æ·»åŠ é…ç½®é©±åŠ¨æ¶æ„ç« èŠ‚
- [ ] 14:00-17:00: æ›´æ–°æ•°æ®ç»“æ„å’ŒAPIæ–‡æ¡£
- [ ] 17:00-18:00: ç¬¬ä¸€è½®å®¡æŸ¥

### ç¬¬2å¤©ï¼ˆ6å°æ—¶ï¼‰
- [ ] 09:00-11:00: æ›´æ–°å®æ–½è®¡åˆ’æ–‡æ¡£
- [ ] 11:00-12:00: ä¿®æ”¹æ­¥éª¤è¯´æ˜
- [ ] 14:00-16:00: æ›´æ–°æ•°æ®æµç¨‹æ–‡æ¡£
- [ ] 16:00-17:00: ç¬¬äºŒè½®å®¡æŸ¥

### ç¬¬3å¤©ï¼ˆ6å°æ—¶ï¼‰
- [ ] 09:00-11:00: æ›´æ–°CLAUDE.md
- [ ] 11:00-12:00: åˆ›å»ºè¿ç§»æŒ‡å—
- [ ] 14:00-16:00: æ•´ä½“ä¸€è‡´æ€§æ£€æŸ¥
- [ ] 16:00-17:00: æœ€ç»ˆå®¡æŸ¥å’Œå‘å¸ƒ

---

## è´¨é‡æ£€æŸ¥æ¸…å•

### å†…å®¹å®Œæ•´æ€§
- [ ] æ‰€æœ‰"30ä¸ªè¡¨æ ¼"å·²æ›¿æ¢
- [ ] æ‰€æœ‰"è™šæ‹Ÿ"æè¿°å·²æ›´æ–°
- [ ] RealDocumentLoaderå·²æ–‡æ¡£åŒ–
- [ ] é…ç½®æ–‡ä»¶ç»“æ„å·²è¯´æ˜
- [ ] APIå˜æ›´å·²è®°å½•

### æŠ€æœ¯å‡†ç¡®æ€§
- [ ] ä»£ç ç¤ºä¾‹å¯è¿è¡Œ
- [ ] é…ç½®ç¤ºä¾‹æ­£ç¡®
- [ ] è·¯å¾„ä¿¡æ¯å‡†ç¡®
- [ ] ç‰ˆæœ¬å·å·²æ›´æ–°

### æ ¼å¼è§„èŒƒ
- [ ] Markdownæ ¼å¼æ­£ç¡®
- [ ] ä»£ç é«˜äº®æ­£å¸¸
- [ ] è¡¨æ ¼å¯¹é½æ•´é½
- [ ] é“¾æ¥å¯è®¿é—®

---

**å®æ–½æ–¹æ¡ˆç»“æŸ**

æœ¬æ–¹æ¡ˆæä¾›äº†æ‰€æœ‰éœ€è¦ä¿®æ”¹çš„å…·ä½“å†…å®¹ï¼Œå¯ç›´æ¥ç”¨äºæ–‡æ¡£æ›´æ–°å·¥ä½œã€‚å»ºè®®æŒ‰ç…§æ—¶é—´è¡¨é€æ­¥å®æ–½ï¼Œç¡®ä¿è´¨é‡ã€‚