# è…¾è®¯æ–‡æ¡£ä¸Šä¼ æ¨¡å—é›†æˆæ–¹æ¡ˆ

## âš ï¸ é‡è¦æ›´æ–°ï¼ˆ2025-09-20ï¼‰

**å…³é”®é—®é¢˜**ï¼šç³»ç»Ÿå½“å‰ä½¿ç”¨äº†ä¸´æ—¶ä¿®å¤ç‰ˆæœ¬è€Œéç”Ÿäº§çº§v3æ¨¡å—ï¼Œå¯¼è‡´è¿”å›é”™è¯¯é“¾æ¥ã€‚

**æ­£ç¡®çš„æ¨¡å—ä½¿ç”¨å’Œå‚æ•°é¡ºåº**ï¼š
```python
# æ¨èï¼šä½¿ç”¨ç”Ÿäº§çº§v3æ¨¡å—ï¼ˆ95%+å‡†ç¡®ç‡ï¼‰
from production.core_modules.tencent_doc_upload_production_v3 import sync_upload_v3

# æ­£ç¡®çš„å‚æ•°é¡ºåºï¼ˆcookie_stringåœ¨å‰ï¼Œfile_pathåœ¨åï¼‰
result = sync_upload_v3(cookie_string, file_path)

# å¤„ç†è¿”å›å€¼ï¼ˆå¯èƒ½æ˜¯dictï¼‰
if isinstance(result, dict):
    doc_url = result.get('url', result.get('doc_url', ''))
    success = result.get('success', False)
else:
    doc_url = result

# é¿å…ï¼šä½¿ç”¨ä¸´æ—¶ç‰ˆæœ¬ï¼ˆè¿”å›é”™è¯¯é“¾æ¥ï¼‰
# from tencent_doc_uploader import sync_upload_file  # âŒ

# é¿å…ï¼šé”™è¯¯çš„å‚æ•°é¡ºåº
# result = sync_upload_v3(file_path, cookie_string)  # âŒ å‚æ•°é¡ºåºé”™è¯¯
```

**å‚æ•°è¯´æ˜**ï¼š
- `cookie_string` (str): è…¾è®¯æ–‡æ¡£çš„è®¤è¯Cookieå­—ç¬¦ä¸²ï¼Œå¿…é¡»æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°
- `file_path` (str): è¦ä¸Šä¼ çš„Excelæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°
- `headless` (bool, å¯é€‰): æ˜¯å¦æ— å¤´æ¨¡å¼è¿è¡Œï¼Œé»˜è®¤True

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†ä¸Šä¼ æ¨¡å—å¦‚ä½•é›†æˆåˆ°ä¸»æµç¨‹ä¸­ï¼Œå®ç°ä»æ–‡ä»¶ç”Ÿæˆåˆ°è‡ªåŠ¨ä¸Šä¼ ã€URLç®¡ç†çš„å®Œæ•´é“¾è·¯ã€‚

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸»å·¥ä½œæµç¨‹ (8093)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  1. CSVä¸‹è½½ â”€â”€> 2. æ•°æ®å¯¹æ¯” â”€â”€> 3. Excelç”Ÿæˆ â”€â”€> 4. è‡ªåŠ¨ä¸Šä¼ â”‚
â”‚       â”‚              â”‚              â”‚              â”‚      â”‚
â”‚       â–¼              â–¼              â–¼              â–¼      â”‚
â”‚  WeekTimeManager  Comparator   ExcelGenerator  UploadV3  â”‚
â”‚                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    åŸºç¡€è®¾æ–½å±‚                             â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Cookie Managerâ”‚  â”‚ URL Manager  â”‚  â”‚File Manager  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”‘ å…³é”®è®¾è®¡å†³ç­–

### 1. Cookieç»Ÿä¸€ç®¡ç†

**åŸåˆ™**ï¼šæ‰€æœ‰æ¨¡å—å…±äº«åŒä¸€ä¸ªCookieæº

```python
# è·å–Cookieçš„ç»Ÿä¸€æ–¹å¼ï¼ˆæ›´æ–° 2025-09-20ï¼‰
# æ–¹å¼1ï¼šä»cookie_managerè·å–
from production.core_modules.cookie_manager import CookieManager

cookie_manager = CookieManager()
cookie = await cookie_manager.get_best_cookie()

# æ–¹å¼2ï¼šä»é…ç½®æ–‡ä»¶è¯»å–ï¼ˆæ¨èï¼‰
import json

with open('/root/projects/tencent-doc-manager/config/cookies.json', 'r') as f:
    cookies = json.load(f)

# æ³¨æ„ï¼šå­—æ®µåå¯èƒ½æ˜¯'current_cookies'æˆ–'cookies'
cookie_str = cookies.get('current_cookies', cookies.get('cookies', ''))
```

**Cookieé…ç½®æ–‡ä»¶ç»“æ„**ï¼š
```json
{
  "current_cookies": "fingerprint=xxx; DOC_SID=xxx; ...",  // ä¸»è¦å­—æ®µ
  "cookies": "...",            // å¤‡ç”¨å­—æ®µï¼ˆå‘åå…¼å®¹ï¼‰
  "last_update": "2025-09-20T13:31:37.123686",
  "is_valid": true,
  "validation_message": "âœ… Cookieæ ¼å¼æ­£ç¡®"
}
```

**ä¼˜åŠ¿**ï¼š
- âœ… ä¸‹è½½å’Œä¸Šä¼ ä½¿ç”¨ç›¸åŒCookie
- âœ… é›†ä¸­ç®¡ç†Cookieç”Ÿå‘½å‘¨æœŸ
- âœ… è‡ªåŠ¨å¤„ç†Cookieåˆ·æ–°
- âœ… å…¼å®¹å¤šç§å­—æ®µåæ ¼å¼

### 2. æ–‡ä»¶å‘½åè§„èŒƒï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰

**æ ¼å¼**ï¼š`tencent_{æ–‡æ¡£å}_{æ—¶é—´æˆ³}_{ç‰ˆæœ¬ç±»å‹}_W{å‘¨æ•°}.{æ‰©å±•å}`

**ç¤ºä¾‹**ï¼š
```
tencent_å‰¯æœ¬-æµ‹è¯•ç‰ˆæœ¬-å‡ºå›½é”€å”®è®¡åˆ’è¡¨_20250910_120000_baseline_W36.csv
risk_analysis_report_20250910_120000.xlsx
```

**å”¯ä¸€æ€§ä¿è¯**ï¼š
- æ—¶é—´æˆ³ç²¾ç¡®åˆ°ç§’ï¼ˆYYYYmmdd_HHMMSSï¼‰
- åŒ…å«å‘¨æ•°å’Œç‰ˆæœ¬ç±»å‹
- æ–‡æ¡£å+æ—¶é—´æˆ³ç»„åˆç¡®ä¿å”¯ä¸€

### 3. URLæ˜ å°„å­˜å‚¨

**å­˜å‚¨ä½ç½®**ï¼š`/root/projects/tencent-doc-manager/data/upload_mappings.json`

**å­˜å‚¨æ ¼å¼**ï¼š
```json
{
  "mappings": [
    {
      "file_path": "/full/path/to/file.xlsx",
      "file_name": "risk_analysis_report_20250910_120000.xlsx",
      "doc_url": "https://docs.qq.com/sheet/DWHJjWmZkTUZkcWpB",
      "upload_time": "2025-09-10 12:00:00",
      "doc_name": "risk_analysis_report",
      "week_number": "W36",
      "version_type": "midweek",
      "metadata": {
        "original_doc": "å‰¯æœ¬-æµ‹è¯•ç‰ˆæœ¬-å‡ºå›½é”€å”®è®¡åˆ’è¡¨",
        "file_size": 12345,
        "upload_method": "v3"
      }
    }
  ],
  "last_updated": "2025-09-10 12:00:00"
}
```

---

## ğŸ”„ é›†æˆæµç¨‹

### ä¸»æµç¨‹é›†æˆç‚¹

#### 1. Excelç”Ÿæˆåè‡ªåŠ¨ä¸Šä¼ 

```python
# åœ¨complete_workflow_ui.pyä¸­
async def generate_and_upload_excel(data):
    # 1. ç”ŸæˆExcel
    excel_file = await generate_excel_report(data)
    
    # 2. è‡ªåŠ¨ä¸Šä¼ 
    if config.get('auto_upload'):
        from production.core_modules.workflow_integration import get_workflow_manager
        workflow = get_workflow_manager()
        
        doc_url = await workflow.process_upload(excel_file)
        
        # 3. è¿”å›ç»“æœåŒ…å«URL
        return {
            'file': excel_file,
            'url': doc_url,
            'success': True
        }
```

#### 2. æ‰¹é‡å¤„ç†æ¨¡å¼

```python
# æ‰¹é‡ä¸Šä¼ å†å²æ–‡ä»¶
async def batch_upload_historical_files():
    workflow = get_workflow_manager()
    
    # æŸ¥æ‰¾æœªä¸Šä¼ çš„æ–‡ä»¶
    patterns = ['risk_analysis_report_*.xlsx', 'tencent_*_final_W*.xlsx']
    
    for pattern in patterns:
        files = Path('excel_outputs').glob(pattern)
        for file in files:
            # æ£€æŸ¥æ˜¯å¦å·²ä¸Šä¼ 
            if not workflow.get_upload_url_for_file(str(file)):
                await workflow.process_upload(str(file))
```

#### 3. URLæŸ¥è¯¢æ¥å£

```python
# é€šè¿‡æ–‡ä»¶æŸ¥æ‰¾å¯¹åº”URL
def get_document_url(file_path: str) -> Optional[str]:
    from production.core_modules.upload_url_manager import get_manager
    
    manager = get_manager()
    record = manager.get_by_file(file_path)
    
    return record.doc_url if record else None
```

---

## ğŸ“Š æ•°æ®æµ

### å®Œæ•´æ•°æ®æµç¨‹

```
1. ç”¨æˆ·è¯·æ±‚ä¸‹è½½CSV
   â†“
2. WeekTimeManagerç”Ÿæˆæ ‡å‡†æ–‡ä»¶å
   â†“
3. ä¸‹è½½CSVåˆ°æ ‡å‡†è·¯å¾„
   â†“
4. æ‰§è¡Œæ•°æ®å¯¹æ¯”åˆ†æ
   â†“
5. ç”ŸæˆExcelæŠ¥å‘Šï¼ˆæ ‡å‡†å‘½åï¼‰
   â†“
6. è‡ªåŠ¨è§¦å‘ä¸Šä¼ ï¼ˆv3æ¨¡å—ï¼‰
   â†“
7. è·å–è…¾è®¯æ–‡æ¡£URL
   â†“
8. å­˜å‚¨æ–‡ä»¶-URLæ˜ å°„
   â†“
9. è¿”å›å®Œæ•´ç»“æœç»™ç”¨æˆ·
```

---

## ğŸ› ï¸ APIæ¥å£

### 1. ä¸Šä¼ æ–‡ä»¶

```python
POST /api/upload
{
    "file_path": "/path/to/file.xlsx",
    "auto_upload": true
}

Response:
{
    "success": true,
    "url": "https://docs.qq.com/sheet/xxx",
    "doc_name": "file",
    "message": "ä¸Šä¼ æˆåŠŸ"
}
```

### 2. æŸ¥è¯¢URL

```python
GET /api/get-url?file_path=/path/to/file.xlsx

Response:
{
    "file_path": "/path/to/file.xlsx",
    "doc_url": "https://docs.qq.com/sheet/xxx",
    "upload_time": "2025-09-10 12:00:00"
}
```

### 3. ä¸Šä¼ å†å²

```python
GET /api/upload-history?limit=10

Response:
{
    "history": [
        {
            "file_name": "risk_analysis_report_20250910.xlsx",
            "doc_url": "https://docs.qq.com/sheet/xxx",
            "upload_time": "2025-09-10 12:00:00"
        }
    ]
}
```

---

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

### 1. å®Œå…¨è‡ªåŠ¨åŒ–
- æ–‡ä»¶ç”Ÿæˆåè‡ªåŠ¨ä¸Šä¼ 
- æ— éœ€äººå·¥å¹²é¢„
- æ”¯æŒæ‰¹é‡å¤„ç†

### 2. å¯è¿½æº¯æ€§
- æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å”¯ä¸€æ ‡è¯†
- å®Œæ•´çš„ä¸Šä¼ å†å²è®°å½•
- æ–‡ä»¶ä¸URLçš„ç²¾ç¡®æ˜ å°„

### 3. å®¹é”™æœºåˆ¶
- é‡å¤ä¸Šä¼ æ£€æµ‹
- å¤±è´¥é‡è¯•
- æ˜ å°„å…³ç³»æŒä¹…åŒ–

### 4. çµæ´»é…ç½®
- å¯é…ç½®æ˜¯å¦è‡ªåŠ¨ä¸Šä¼ 
- æ”¯æŒæ‰¹é‡/å•ä¸ªä¸Šä¼ 
- ä¸Šä¼ å»¶è¿Ÿæ§åˆ¶

### 5. URLå¸¸æ€æ˜¾ç¤ºæŠ€æœ¯ (2025-09-14æ›´æ–°)
- **è‡ªåŠ¨åŠ è½½å­˜å‚¨çš„URL**: ä½¿ç”¨React useEffecté’©å­åœ¨ç»„ä»¶æŒ‚è½½æ—¶åŠ è½½
- **æ­£ç¡®çš„è½¬ä¹‰å¤„ç†**: JavaScriptä¸­ä½¿ç”¨`\\n`è½¬ä¹‰åºåˆ—è€Œéå®é™…æ¢è¡Œç¬¦
- **å®æ—¶åŒæ­¥æ˜¾ç¤º**: é€šè¿‡controlled componentæ¨¡å¼ä¿æŒUIä¸å­˜å‚¨åŒæ­¥

#### æŠ€æœ¯å®ç°ç»†èŠ‚ï¼š

```javascript
// åŠ è½½å·²å­˜å‚¨çš„é“¾æ¥
const loadStoredLinks = async () => {
  try {
    const response = await fetch('/api/get-download-links');
    const result = await response.json();

    if (result.success && result.data && result.data.document_links) {
      const links = result.data.document_links;

      // é‡è¦ï¼šä½¿ç”¨\\nè½¬ä¹‰åºåˆ—ï¼Œé¿å…JavaScriptè§£æé”™è¯¯
      const linkText = links
        .filter(link => link.enabled !== false)
        .map(link => `ã€è…¾è®¯æ–‡æ¡£ã€‘${link.name}\\n${link.url}`)
        .join('\\n\\n');

      setTableLinks(linkText);  // æ›´æ–°textareaæ˜¾ç¤º
      setStoredUrls(links);     // ä¿å­˜åŸå§‹æ•°æ®
    }
  } catch (error) {
    console.error('âŒ åŠ è½½é“¾æ¥å¤±è´¥:', error);
  }
};

// åœ¨ç»„ä»¶æŒ‚è½½æ—¶è‡ªåŠ¨åŠ è½½
React.useEffect(() => {
  if (isOpen) {
    loadStoredLinks();  // åŠ è½½URL
    loadCookieConfig(); // åŠ è½½Cookie
    // ... å…¶ä»–åˆå§‹åŒ–
  }
}, [isOpen]);
```

#### å…³é”®æ³¨æ„äº‹é¡¹ï¼š
1. **è½¬ä¹‰åºåˆ—å¤„ç†**: Pythonä¸‰å¼•å·å­—ç¬¦ä¸²ä¸­çš„`\\n`ä¼šä¼ é€’ä¸ºJavaScriptä¸­çš„`\n`
2. **Babelé™åˆ¶**: in-browser Babelè½¬æ¢å™¨æ— æ³•å¤„ç†åŒ…å«å®é™…æ¢è¡Œç¬¦çš„å­—ç¬¦ä¸²å­—é¢é‡
3. **è§£æé€»è¾‘åŒæ­¥**: ç¡®ä¿splitæ“ä½œä½¿ç”¨ç›¸åŒçš„è½¬ä¹‰åºåˆ—`'\\n'`

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šä¸»æµç¨‹ä¸­é›†æˆ

```python
# åœ¨8093ç³»ç»Ÿçš„ä¸»æµç¨‹ä¸­
@app.route('/api/complete-workflow', methods=['POST'])
async def complete_workflow():
    # 1. è·å–è¯·æ±‚æ•°æ®
    doc_urls = request.json.get('urls')
    
    # 2. æ‰§è¡Œå®Œæ•´å·¥ä½œæµ
    workflow = get_workflow_manager()
    results = await workflow.run_complete_workflow(doc_urls)
    
    # 3. è¿”å›ç»“æœï¼ˆåŒ…å«ä¸Šä¼ çš„URLï¼‰
    return jsonify(results)
```

### ç¤ºä¾‹2ï¼šå•ç‹¬ä¸Šä¼ æ–‡ä»¶

```python
# å•ç‹¬ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶
from production.core_modules.workflow_integration import get_workflow_manager

workflow = get_workflow_manager()
file_path = "excel_outputs/report.xlsx"
doc_url = await workflow.process_upload(file_path)

print(f"æ–‡ä»¶å·²ä¸Šä¼ åˆ°: {doc_url}")
```

### ç¤ºä¾‹3ï¼šæŸ¥è¯¢å†å²URL

```python
# æŸ¥è¯¢æŸä¸ªæ–‡ä»¶çš„ä¸Šä¼ URL
from production.core_modules.upload_url_manager import get_manager

manager = get_manager()

# é€šè¿‡æ–‡ä»¶åæŸ¥è¯¢
record = manager.get_by_name("risk_analysis_report_20250910_120000.xlsx")
if record:
    print(f"æ–‡æ¡£URL: {record.doc_url}")
    print(f"ä¸Šä¼ æ—¶é—´: {record.upload_time}")

# æŸ¥è¯¢æŸå‘¨çš„æ‰€æœ‰ä¸Šä¼ 
week_records = manager.get_by_week("W36")
for record in week_records:
    print(f"{record.file_name} -> {record.doc_url}")
```

---

## ğŸ”§ é…ç½®æ–‡ä»¶

### workflow_config.json

```json
{
    "auto_upload": true,
    "upload_delay": 5,
    "batch_upload": false,
    "max_batch_size": 5,
    "preserve_local": true,
    "upload_patterns": [
        "risk_analysis_report_*.xlsx",
        "tencent_*_final_W*.xlsx",
        "comparison_report_*.xlsx"
    ]
}
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡ï¼ˆ2025-09-20æ›´æ–°ï¼‰

| æŒ‡æ ‡ | æ•°å€¼ | å¤‡æ³¨ |
|------|------|------|
| å•æ–‡ä»¶ä¸Šä¼ è€—æ—¶ | 20-30ç§’ | v3æ¨¡å—å®æµ‹çº¦25ç§’ |
| æ‰¹é‡ä¸Šä¼ é€Ÿåº¦ | 5ä¸ª/åˆ†é’Ÿ | - |
| URLæ˜ å°„æŸ¥è¯¢ | <1ms | - |
| å­˜å‚¨ç©ºé—´å ç”¨ | ~1KB/è®°å½• | - |
| Cookieæœ‰æ•ˆæœŸ | 7-14å¤© | å®æµ‹ç»“æœï¼Œé24-48å°æ—¶ |
| é“¾æ¥å‡†ç¡®ç‡ | 95%+ | ä½¿ç”¨v3æ¨¡å— |

## ğŸ”¬ å®é™…æµ‹è¯•æ¡ˆä¾‹ï¼ˆ2025-09-20ï¼‰

### æˆåŠŸæ¡ˆä¾‹ï¼šæ¶‚è‰²Excelä¸Šä¼ 

**æµ‹è¯•æ–‡ä»¶**ï¼š`tencent_111æµ‹è¯•ç‰ˆæœ¬-å°çº¢ä¹¦éƒ¨é—¨_20250919_2255_midweek_W38_colored.xlsx`
- æ–‡ä»¶å¤§å°ï¼š47,085 bytes
- æ¶‚è‰²å•å…ƒæ ¼ï¼š54ä¸ª
- ä¸Šä¼ è€—æ—¶ï¼šçº¦30ç§’

**ä¸Šä¼ è¿‡ç¨‹æ—¥å¿—**ï¼š
```
[01:21:52] âœ… æµè§ˆå™¨å¯åŠ¨æˆåŠŸ
[01:21:52] ğŸ” å¼€å§‹Cookieç™»å½•...
[01:21:52] âœ… å·²æ·»åŠ  28 ä¸ªCookies
[01:21:58] âœ… ç™»å½•æˆåŠŸï¼
[01:21:58] ğŸ“¤ å¼€å§‹ä¸Šä¼ : tencent_111æµ‹è¯•ç‰ˆæœ¬...
[01:22:01] â³ ç­‰å¾…ä¸Šä¼ å®Œæˆ...
[01:22:21] âœ… å¯¼å…¥å¯¹è¯æ¡†å·²å…³é—­
[01:22:21] âœ… é€šè¿‡æ–‡ä»¶ååŒ¹é…æ‰¾åˆ°æ–‡æ¡£: https://docs.qq.com/sheet/DWGxaRUpzVWxuVHVH
[01:22:21] âœ… ä¸Šä¼ æˆåŠŸ
```

**å…³é”®å‘ç°**ï¼š
1. Cookieè§£æéœ€è¦æ­£ç¡®å¤„ç†28ä¸ªcookieé¡¹
2. å‚æ•°é¡ºåºå¿…é¡»æ˜¯(cookie_string, file_path)
3. è¿”å›å€¼å¯èƒ½æ˜¯dictï¼Œéœ€è¦æå–urlå­—æ®µ
4. è…¾è®¯Exceléœ€è¦å…ˆä¿®å¤ç©ºfillæ ‡ç­¾æ‰èƒ½æ¶‚è‰²

---

## ğŸš€ æœªæ¥ä¼˜åŒ–

1. **å¹¶å‘ä¸Šä¼ **ï¼šæ”¯æŒå¤šæ–‡ä»¶å¹¶å‘ä¸Šä¼ 
2. **æ–­ç‚¹ç»­ä¼ **ï¼šå¤§æ–‡ä»¶æ–­ç‚¹ç»­ä¼ æ”¯æŒ
3. **ç‰ˆæœ¬ç®¡ç†**ï¼šåŒä¸€æ–‡ä»¶å¤šç‰ˆæœ¬ç®¡ç†
4. **æƒé™æ§åˆ¶**ï¼šåŸºäºç”¨æˆ·çš„ä¸Šä¼ æƒé™
5. **å®¡è®¡æ—¥å¿—**ï¼šå®Œæ•´çš„æ“ä½œå®¡è®¡é“¾

---

## 6. åŸºçº¿æ–‡ä»¶ç®¡ç†è§„èŒƒ (2025-09-15æ›´æ–°)

### åŠŸèƒ½æ¦‚è¿°
åŸºçº¿æ–‡ä»¶ç®¡ç†æä¾›æ–‡æ¡£ç‰ˆæœ¬åŸºå‡†å»ºç«‹å’Œç»´æŠ¤åŠŸèƒ½ï¼Œæ”¯æŒæ‰¹é‡ä¸‹è½½å’Œè½¯åˆ é™¤æœºåˆ¶ã€‚

### æ ¸å¿ƒåŠŸèƒ½

#### 6.1 å¤šè¡ŒURLè¾“å…¥æ”¯æŒ
æ”¯æŒä¸URLç®¡ç†ç›¸åŒçš„å¤šè¡Œæ‰¹é‡è¾“å…¥æ ¼å¼ï¼š

```
ã€è…¾è®¯æ–‡æ¡£ã€‘æ–‡æ¡£åç§°1 https://docs.qq.com/sheet/xxx
ã€è…¾è®¯æ–‡æ¡£ã€‘æ–‡æ¡£åç§°2 https://docs.qq.com/sheet/yyy
https://docs.qq.com/sheet/zzz
```

**è§£æè§„åˆ™**ï¼š
- è‡ªåŠ¨è¯†åˆ«ã€è…¾è®¯æ–‡æ¡£ã€‘æ ¼å¼çš„åˆ†äº«é“¾æ¥
- æå–æ–‡æ¡£åç§°å’ŒURL
- æ”¯æŒçº¯URLæ ¼å¼ï¼ˆæ— åç§°ï¼‰
- å¿½ç•¥ç©ºè¡Œ

#### 6.2 è½¯åˆ é™¤æœºåˆ¶
åŒååŸºçº¿æ–‡ä»¶ç®¡ç†é‡‡ç”¨è½¯åˆ é™¤ç­–ç•¥ï¼š

**å·¥ä½œåŸç†**ï¼š
1. æ–°æ–‡ä»¶ä¸‹è½½æ—¶æ£€æŸ¥åŒåæ–‡ä»¶
2. å°†æ—§æ–‡ä»¶ç§»åŠ¨åˆ° `.deleted` éšè—æ–‡ä»¶å¤¹
3. æ·»åŠ åˆ é™¤æ—¶é—´æˆ³å‰ç¼€ï¼š`deleted_YYYYMMDD_HHMMSS_åŸæ–‡ä»¶å`
4. ä¸»ç›®å½•åªä¿ç•™æœ€æ–°ç‰ˆæœ¬

**ä¼˜åŠ¿**ï¼š
- âœ… é˜²æ­¢æ–‡ä»¶ä¸¢å¤±
- âœ… æ”¯æŒå†å²è¿½æº¯
- âœ… é¿å…é‡å¤æ··ä¹±
- âœ… è½¯åˆ é™¤æ–‡ä»¶ä¸è¢«æŸ¥æ‰¾å‡½æ•°å‘ç°

#### 6.3 å­˜å‚¨ç»“æ„
```
csv_versions/
â””â”€â”€ 2025_W{å‘¨æ•°}/
    â””â”€â”€ baseline/
        â”œâ”€â”€ tencent_{æ–‡æ¡£å}_{æ—¶é—´æˆ³}_baseline_W{å‘¨æ•°}.csv  # å½“å‰åŸºçº¿
        â””â”€â”€ .deleted/                                      # è½¯åˆ é™¤æ–‡ä»¶å¤¹
            â””â”€â”€ deleted_{åˆ é™¤æ—¶é—´}_{åŸæ–‡ä»¶å}.csv          # å†å²ç‰ˆæœ¬
```

#### 6.4 APIæ¥å£

**è·å–åŸºçº¿æ–‡ä»¶åˆ—è¡¨**
```http
GET /api/baseline-files?week={å‘¨æ•°}
```

**ä¸‹è½½åŸºçº¿æ–‡ä»¶**
```http
POST /api/baseline-files
{
    "url": "https://docs.qq.com/sheet/xxx",
    "cookie": "cookie_string",
    "week": 38
}
```

**åˆ é™¤åŸºçº¿æ–‡ä»¶**
```http
DELETE /api/baseline-files
{
    "filename": "tencent_xxx.csv"
}
```

### æµ‹è¯•éªŒè¯ç»“æœ
- âœ… å¤šè¡ŒURLè§£ææ­£å¸¸
- âœ… è½¯åˆ é™¤æœºåˆ¶å·¥ä½œæ­£å¸¸
- âœ… æ–‡ä»¶å‘½åè§„èŒƒç¬¦åˆè¦æ±‚
- âœ… å­˜å‚¨è·¯å¾„ç»„ç»‡åˆç†

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [07-è…¾è®¯æ–‡æ¡£ä¸Šä¼ æŠ€æœ¯è§„æ ¼.md](./07-è…¾è®¯æ–‡æ¡£ä¸Šä¼ æŠ€æœ¯è§„æ ¼.md)
- [02-æ—¶é—´ç®¡ç†å’Œæ–‡ä»¶ç‰ˆæœ¬è§„æ ¼.md](./02-æ—¶é—´ç®¡ç†å’Œæ–‡ä»¶ç‰ˆæœ¬è§„æ ¼.md)
- [ç³»ç»ŸåŠŸèƒ½ç»„ä»¶å®Œæ•´æ¸…å•.md](../ç³»ç»ŸåŠŸèƒ½ç»„ä»¶å®Œæ•´æ¸…å•.md)