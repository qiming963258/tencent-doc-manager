<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <meta name=\"description\" content=\"腾讯文档自动化服务 - 高效管理您的腾讯文档，支持下载、上传、分析、修改\">\n    <meta name=\"keywords\" content=\"腾讯文档,自动化,文档管理,Excel,CSV,下载,上传\">\n    <meta name=\"author\" content=\"腾讯文档自动化服务\">\n    \n    <!-- Open Graph / 社交媒体元数据 -->\n    <meta property=\"og:type\" content=\"website\">\n    <meta property=\"og:title\" content=\"腾讯文档自动化服务\">\n    <meta property=\"og:description\" content=\"高效管理您的腾讯文档 - 下载、上传、分析、修改一站式解决\">\n    <meta property=\"og:site_name\" content=\"腾讯文档自动化服务\">\n    \n    <!-- 防止缓存 -->\n    <meta http-equiv=\"Cache-Control\" content=\"no-cache, no-store, must-revalidate\">\n    <meta http-equiv=\"Pragma\" content=\"no-cache\">\n    <meta http-equiv=\"Expires\" content=\"0\">\n    \n    <title>腾讯文档自动化服务 | 现代化文档管理平台</title>\n    \n    <!-- 预加载关键资源 -->\n    <link rel=\"preload\" href=\"/static/css/modern-theme.css\" as=\"style\">\n    <link rel=\"preload\" href=\"/static/js/components.js\" as=\"script\">\n    <link rel=\"preload\" href=\"/static/js/api-client.js\" as=\"script\">\n    <link rel=\"preload\" href=\"/static/js/app.js\" as=\"script\">\n    \n    <!-- Bootstrap Icons -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css\" rel=\"stylesheet\">\n    \n    <!-- 现代主题样式 -->\n    <link href=\"/static/css/modern-theme.css\" rel=\"stylesheet\">\n    \n    <!-- 自定义样式补充 -->\n    <style>\n        /* 组件特定样式 */\n        .btn {\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            gap: var(--space-2);\n            padding: var(--space-3) var(--space-6);\n            font-size: 14px;\n            font-weight: var(--font-weight-semibold);\n            line-height: 1.4;\n            text-decoration: none;\n            border: 1px solid transparent;\n            border-radius: var(--radius-lg);\n            cursor: pointer;\n            transition: all var(--duration-150) ease;\n            white-space: nowrap;\n            position: relative;\n            overflow: hidden;\n            user-select: none;\n            -webkit-tap-highlight-color: transparent;\n        }\n        \n        .btn:focus {\n            outline: 2px solid var(--color-primary-500);\n            outline-offset: 2px;\n        }\n        \n        .btn:disabled {\n            opacity: 0.5;\n            cursor: not-allowed;\n            pointer-events: none;\n        }\n        \n        .btn-primary {\n            background: linear-gradient(135deg, var(--color-primary-600), var(--color-primary-700));\n            color: white;\n            border-color: var(--color-primary-600);\n        }\n        \n        .btn-primary:hover {\n            background: linear-gradient(135deg, var(--color-primary-700), var(--color-primary-800));\n            transform: translateY(-1px);\n            box-shadow: var(--shadow-lg);\n        }\n        \n        .btn-secondary {\n            background: var(--bg-secondary);\n            color: var(--text-primary);\n            border-color: var(--border-color);\n        }\n        \n        .btn-secondary:hover {\n            background: var(--bg-tertiary);\n            border-color: var(--border-hover);\n        }\n        \n        .btn-outline {\n            background: transparent;\n            color: var(--color-primary-600);\n            border-color: var(--color-primary-600);\n        }\n        \n        .btn-outline:hover {\n            background: var(--color-primary-600);\n            color: white;\n        }\n        \n        .btn-ghost {\n            background: transparent;\n            color: var(--text-secondary);\n            border: none;\n        }\n        \n        .btn-ghost:hover {\n            background: var(--bg-tertiary);\n            color: var(--text-primary);\n        }\n        \n        .btn-sm {\n            padding: var(--space-2) var(--space-4);\n            font-size: 13px;\n        }\n        \n        .btn-lg {\n            padding: var(--space-4) var(--space-8);\n            font-size: 16px;\n        }\n        \n        /* 卡片样式 */\n        .card {\n            background: var(--bg-secondary);\n            border: 1px solid var(--border-color);\n            border-radius: var(--radius-2xl);\n            box-shadow: var(--shadow-sm);\n            transition: all var(--duration-200) ease;\n            overflow: hidden;\n        }\n        \n        .card:hover {\n            box-shadow: var(--shadow-md);\n        }\n        \n        .card-body {\n            padding: var(--space-8);\n        }\n        \n        .card-header {\n            padding: var(--space-6) var(--space-8);\n            border-bottom: 1px solid var(--border-color);\n            background: var(--bg-tertiary);\n        }\n        \n        .card-footer {\n            padding: var(--space-6) var(--space-8);\n            border-top: 1px solid var(--border-color);\n            background: var(--bg-tertiary);\n        }\n        \n        /* 表单样式 */\n        .form-group {\n            margin-bottom: var(--space-6);\n        }\n        \n        .form-label {\n            display: flex;\n            align-items: center;\n            gap: var(--space-2);\n            font-size: var(--font-size-sm);\n            font-weight: var(--font-weight-semibold);\n            color: var(--text-primary);\n            margin-bottom: var(--space-2);\n        }\n        \n        .form-input,\n        .form-textarea,\n        .form-select {\n            width: 100%;\n            padding: var(--space-3) var(--space-4);\n            font-size: var(--font-size-base);\n            line-height: 1.5;\n            color: var(--text-primary);\n            background: var(--bg-secondary);\n            border: 2px solid var(--border-color);\n            border-radius: var(--radius-lg);\n            transition: all var(--duration-150) ease;\n        }\n        \n        .form-input:focus,\n        .form-textarea:focus,\n        .form-select:focus {\n            outline: none;\n            border-color: var(--color-primary-500);\n            box-shadow: 0 0 0 3px var(--color-primary-100);\n        }\n        \n        [data-theme=\"dark\"] .form-input:focus,\n        [data-theme=\"dark\"] .form-textarea:focus,\n        [data-theme=\"dark\"] .form-select:focus {\n            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);\n        }\n        \n        .form-input::placeholder,\n        .form-textarea::placeholder {\n            color: var(--text-muted);\n        }\n        \n        .form-textarea {\n            resize: vertical;\n            min-height: 120px;\n        }\n        \n        /* 导航样式 */\n        .nav {\n            display: flex;\n            border-bottom: 2px solid var(--border-color);\n        }\n        \n        .nav-link {\n            display: flex;\n            align-items: center;\n            gap: var(--space-2);\n            padding: var(--space-4) var(--space-6);\n            color: var(--text-secondary);\n            text-decoration: none;\n            border-bottom: 3px solid transparent;\n            transition: all var(--duration-150) ease;\n            font-weight: var(--font-weight-medium);\n            position: relative;\n        }\n        \n        .nav-link:hover {\n            color: var(--text-primary);\n            background: var(--bg-tertiary);\n        }\n        \n        .nav-link.active {\n            color: var(--color-primary-600);\n            border-bottom-color: var(--color-primary-600);\n            background: var(--bg-accent);\n        }\n        \n        /* 主布局 */\n        .app-layout {\n            min-height: 100vh;\n            background: linear-gradient(135deg, var(--color-primary-50) 0%, var(--color-gray-50) 100%);\n            transition: background var(--duration-300) ease;\n        }\n        \n        [data-theme=\"dark\"] .app-layout {\n            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--color-gray-800) 100%);\n        }\n        \n        .app-header {\n            background: var(--bg-secondary);\n            border-bottom: 1px solid var(--border-color);\n            backdrop-filter: blur(10px);\n            -webkit-backdrop-filter: blur(10px);\n            position: sticky;\n            top: 0;\n            z-index: var(--z-sticky);\n        }\n        \n        .app-main {\n            flex: 1;\n            padding: var(--space-8) 0;\n        }\n        \n        .app-footer {\n            background: var(--bg-secondary);\n            border-top: 1px solid var(--border-color);\n            padding: var(--space-6) 0;\n            text-align: center;\n            color: var(--text-muted);\n            font-size: var(--font-size-sm);\n        }\n        \n        /* 状态指示器 */\n        .status-indicator {\n            display: inline-flex;\n            align-items: center;\n            gap: var(--space-1);\n            padding: var(--space-1) var(--space-2);\n            font-size: var(--font-size-xs);\n            font-weight: var(--font-weight-medium);\n            border-radius: var(--radius-full);\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n        }\n        \n        .status-indicator.success {\n            background: rgba(16, 185, 129, 0.1);\n            color: var(--color-success);\n        }\n        \n        .status-indicator.warning {\n            background: rgba(245, 158, 11, 0.1);\n            color: var(--color-warning);\n        }\n        \n        .status-indicator.error {\n            background: rgba(239, 68, 68, 0.1);\n            color: var(--color-error);\n        }\n        \n        .status-indicator.info {\n            background: rgba(59, 130, 246, 0.1);\n            color: var(--color-info);\n        }\n        \n        /* 加载状态 */\n        .app-loading .loading-overlay {\n            display: flex;\n        }\n        \n        .loading-overlay {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            bottom: 0;\n            background: rgba(255, 255, 255, 0.8);\n            z-index: var(--z-modal);\n            align-items: center;\n            justify-content: center;\n            backdrop-filter: blur(4px);\n        }\n        \n        [data-theme=\"dark\"] .loading-overlay {\n            background: rgba(0, 0, 0, 0.8);\n        }\n        \n        /* 响应式 */\n        @media (max-width: 768px) {\n            .container {\n                padding: 0 var(--space-3);\n            }\n            \n            .card-body {\n                padding: var(--space-6);\n            }\n            \n            .nav {\n                flex-wrap: wrap;\n            }\n            \n            .nav-link {\n                padding: var(--space-3) var(--space-4);\n                font-size: var(--font-size-sm);\n            }\n            \n            .btn {\n                width: 100%;\n                justify-content: center;\n            }\n            \n            .btn-sm {\n                width: auto;\n            }\n        }\n        \n        /* 性能优化 */\n        .animate-fadeInUp {\n            animation: fadeInUp var(--duration-500) ease-out;\n        }\n        \n        @media (prefers-reduced-motion: reduce) {\n            .animate-fadeInUp {\n                animation: none;\n            }\n        }\n        \n        /* 可访问性 */\n        .sr-only {\n            position: absolute;\n            width: 1px;\n            height: 1px;\n            padding: 0;\n            margin: -1px;\n            overflow: hidden;\n            clip: rect(0, 0, 0, 0);\n            white-space: nowrap;\n            border: 0;\n        }\n        \n        /* 焦点管理 */\n        .focus-trap {\n            outline: 2px solid var(--color-primary-500);\n            outline-offset: 2px;\n        }\n    </style>\n</head>\n<body>\n    <!-- 应用加载覆盖层 -->\n    <div class=\"loading-overlay\" id=\"appLoader\">\n        <div class=\"text-center\">\n            <div class=\"spinner mb-4\"></div>\n            <p class=\"text-muted\">正在加载应用...</p>\n        </div>\n    </div>\n    \n    <!-- 主应用容器 -->\n    <div class=\"app-layout flex flex-col min-h-screen\">\n        <!-- 应用头部 -->\n        <header class=\"app-header\">\n            <div class=\"container\">\n                <div class=\"flex items-center justify-between py-4\">\n                    <!-- Logo 和标题 -->\n                    <div class=\"flex items-center gap-4\">\n                        <i class=\"bi bi-file-earmark-text text-3xl text-primary-600\"></i>\n                        <div>\n                            <h1 class=\"text-2xl font-bold text-primary\">腾讯文档自动化服务</h1>\n                            <p class=\"text-sm text-muted\">现代化文档管理平台</p>\n                        </div>\n                    </div>\n                    \n                    <!-- 工具栏 -->\n                    <div class=\"flex items-center gap-3\">\n                        <!-- 网络状态指示器 -->\n                        <div class=\"status-indicator info\" id=\"networkStatus\">\n                            <i class=\"bi bi-wifi\"></i>\n                            <span>在线</span>\n                        </div>\n                        \n                        <!-- API状态指示器 -->\n                        <div class=\"status-indicator success\" id=\"apiStatus\">\n                            <i class=\"bi bi-server\"></i>\n                            <span>正常</span>\n                        </div>\n                        \n                        <!-- 用户信息 -->\n                        <div class=\"text-sm text-muted\" id=\"userInfo\">\n                            <span id=\"userDisplay\">未设置用户</span>\n                        </div>\n                        \n                        <!-- 主题切换 -->\n                        <button \n                            id=\"themeToggle\" \n                            class=\"btn btn-ghost btn-sm\"\n                            title=\"切换主题\"\n                            aria-label=\"切换明暗主题\"\n                            data-component=\"ThemeToggle\"\n                        >\n                            <i class=\"bi bi-sun\"></i>\n                        </button>\n                    </div>\n                </div>\n                \n                <!-- 导航栏 -->\n                <nav class=\"nav\" role=\"navigation\" aria-label=\"主导航\">\n                    <a href=\"#settings\" class=\"nav-link active\" data-route=\"settings\">\n                        <i class=\"bi bi-gear\" aria-hidden=\"true\"></i>\n                        <span>设置</span>\n                    </a>\n                    <a href=\"#download\" class=\"nav-link\" data-route=\"download\">\n                        <i class=\"bi bi-cloud-download\" aria-hidden=\"true\"></i>\n                        <span>下载文档</span>\n                    </a>\n                    <a href=\"#upload\" class=\"nav-link\" data-route=\"upload\">\n                        <i class=\"bi bi-cloud-upload\" aria-hidden=\"true\"></i>\n                        <span>上传文档</span>\n                    </a>\n                    <a href=\"#analyze\" class=\"nav-link\" data-route=\"analyze\">\n                        <i class=\"bi bi-graph-up\" aria-hidden=\"true\"></i>\n                        <span>分析文档</span>\n                    </a>\n                    <a href=\"#history\" class=\"nav-link\" data-route=\"history\">\n                        <i class=\"bi bi-clock-history\" aria-hidden=\"true\"></i>\n                        <span>历史记录</span>\n                    </a>\n                </nav>\n            </div>\n        </header>\n        \n        <!-- 主内容区域 -->\n        <main class=\"app-main flex-1\" role=\"main\">\n            <div id=\"mainContent\">\n                <!-- 内容将由JavaScript动态加载 -->\n                <div class=\"container\">\n                    <div class=\"text-center py-20\">\n                        <div class=\"spinner mb-4\"></div>\n                        <p class=\"text-muted\">正在加载内容...</p>\n                    </div>\n                </div>\n            </div>\n        </main>\n        \n        <!-- 应用底部 -->\n        <footer class=\"app-footer\">\n            <div class=\"container\">\n                <div class=\"flex flex-col md:flex-row items-center justify-between gap-4\">\n                    <div class=\"text-center md:text-left\">\n                        <p>&copy; 2024 腾讯文档自动化服务. 现代化文档管理解决方案.</p>\n                    </div>\n                    <div class=\"flex items-center gap-6 text-sm\">\n                        <a href=\"#\" class=\"text-muted hover:text-primary transition-colors\">\n                            <i class=\"bi bi-question-circle mr-1\"></i>\n                            使用帮助\n                        </a>\n                        <a href=\"#\" class=\"text-muted hover:text-primary transition-colors\">\n                            <i class=\"bi bi-info-circle mr-1\"></i>\n                            关于\n                        </a>\n                        <a href=\"#\" class=\"text-muted hover:text-primary transition-colors\">\n                            <i class=\"bi bi-github mr-1\"></i>\n                            源码\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </footer>\n    </div>\n    \n    <!-- Toast 通知容器 -->\n    <div class=\"fixed top-4 right-4 z-toast flex flex-col gap-2\" id=\"toastContainer\" aria-live=\"polite\" aria-atomic=\"true\">\n        <!-- Toast消息将动态插入这里 -->\n    </div>\n    \n    <!-- 模态框容器 -->\n    <div id=\"modalContainer\">\n        <!-- 模态框将动态插入这里 -->\n    </div>\n    \n    <!-- JavaScript 模块 -->\n    <!-- 组件系统 -->\n    <script src=\"/static/js/components.js\" defer></script>\n    \n    <!-- API 客户端 -->\n    <script src=\"/static/js/api-client.js\" defer></script>\n    \n    <!-- 主应用逻辑 -->\n    <script src=\"/static/js/app.js\" defer></script>\n    \n    <!-- 应用初始化脚本 -->\n    <script>\n        // 应用启动逻辑\n        document.addEventListener('DOMContentLoaded', function() {\n            // 隐藏加载覆盖层\n            setTimeout(() => {\n                const loader = document.getElementById('appLoader');\n                if (loader) {\n                    loader.style.opacity = '0';\n                    setTimeout(() => {\n                        loader.style.display = 'none';\n                    }, 300);\n                }\n            }, 1000);\n            \n            // 设置导航事件处理\n            setupNavigation();\n            \n            // 设置全局错误处理\n            setupErrorHandling();\n            \n            // 设置性能监控\n            setupPerformanceMonitoring();\n        });\n        \n        function setupNavigation() {\n            // 处理导航链接点击\n            document.addEventListener('click', function(e) {\n                const navLink = e.target.closest('.nav-link[data-route]');\n                if (navLink) {\n                    e.preventDefault();\n                    const route = navLink.dataset.route;\n                    \n                    // 更新活动状态\n                    document.querySelectorAll('.nav-link').forEach(link => {\n                        link.classList.remove('active');\n                    });\n                    navLink.classList.add('active');\n                    \n                    // 如果应用已加载，导航到路由\n                    if (window.app) {\n                        window.app.router.navigateTo(route);\n                    }\n                }\n            });\n        }\n        \n        function setupErrorHandling() {\n            // 全局错误处理\n            window.addEventListener('error', function(e) {\n                console.error('Global error:', e.error);\n                if (window.Components && window.Components.Toast) {\n                    window.Components.Toast.error('系统错误: ' + e.error.message);\n                }\n            });\n            \n            // Promise拒绝处理\n            window.addEventListener('unhandledrejection', function(e) {\n                console.error('Unhandled promise rejection:', e.reason);\n                if (window.Components && window.Components.Toast) {\n                    const message = e.reason.message || '未知错误';\n                    window.Components.Toast.error('操作失败: ' + message);\n                }\n            });\n        }\n        \n        function setupPerformanceMonitoring() {\n            // 监控页面性能\n            if ('performance' in window) {\n                window.addEventListener('load', function() {\n                    setTimeout(() => {\n                        const perfData = performance.getEntriesByType('navigation')[0];\n                        if (perfData) {\n                            console.log('Page load time:', perfData.loadEventEnd - perfData.fetchStart, 'ms');\n                        }\n                    }, 0);\n                });\n            }\n            \n            // 监控内存使用（如果可用）\n            if ('memory' in performance) {\n                setInterval(() => {\n                    const memory = performance.memory;\n                    if (memory.usedJSHeapSize > memory.jsHeapSizeLimit * 0.9) {\n                        console.warn('Memory usage is high:', memory.usedJSHeapSize / 1024 / 1024, 'MB');\n                    }\n                }, 30000);\n            }\n        }\n        \n        // 网络状态监控\n        function updateNetworkStatus() {\n            const indicator = document.getElementById('networkStatus');\n            if (!indicator) return;\n            \n            if (navigator.onLine) {\n                indicator.className = 'status-indicator success';\n                indicator.innerHTML = '<i class=\"bi bi-wifi\"></i><span>在线</span>';\n            } else {\n                indicator.className = 'status-indicator error';\n                indicator.innerHTML = '<i class=\"bi bi-wifi-off\"></i><span>离线</span>';\n            }\n        }\n        \n        // 监听网络状态变化\n        window.addEventListener('online', updateNetworkStatus);\n        window.addEventListener('offline', updateNetworkStatus);\n        \n        // 初始化网络状态\n        updateNetworkStatus();\n        \n        // 监听API状态变化\n        window.addEventListener('api:stateChange', function(e) {\n            const indicator = document.getElementById('apiStatus');\n            if (!indicator) return;\n            \n            if (e.detail.hasPending) {\n                indicator.className = 'status-indicator warning';\n                indicator.innerHTML = '<i class=\"bi bi-hourglass-split animate-spin\"></i><span>处理中</span>';\n            } else {\n                indicator.className = 'status-indicator success';\n                indicator.innerHTML = '<i class=\"bi bi-server\"></i><span>正常</span>';\n            }\n        });\n        \n        // 键盘快捷键\n        document.addEventListener('keydown', function(e) {\n            // Ctrl/Cmd + K: 快速搜索/导航\n            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {\n                e.preventDefault();\n                // 可以实现快速导航功能\n                console.log('Quick navigation shortcut');\n            }\n            \n            // Alt + 数字键: 快速导航到对应标签\n            if (e.altKey && e.key >= '1' && e.key <= '5') {\n                e.preventDefault();\n                const routes = ['settings', 'download', 'upload', 'analyze', 'history'];\n                const index = parseInt(e.key) - 1;\n                if (routes[index] && window.app) {\n                    window.app.router.navigateTo(routes[index]);\n                }\n            }\n        });\n        \n        // 页面可见性API\n        document.addEventListener('visibilitychange', function() {\n            if (document.hidden) {\n                console.log('Page hidden');\n            } else {\n                console.log('Page visible');\n                // 页面重新可见时可以刷新数据\n                if (window.app) {\n                    window.app.checkAPIHealth();\n                }\n            }\n        });\n        \n        // PWA相关（如果需要）\n        if ('serviceWorker' in navigator) {\n            // navigator.serviceWorker.register('/sw.js');\n        }\n    </script>\n    \n    <!-- Google Analytics 或其他分析工具 -->\n    <!-- <script async src=\"https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID\"></script> -->\n</body>\n</html>