用中文回复我
不要输出简化版本
因对复杂任务请：1先阅读相关spec文档，如果文档内容不清晰向我说出需求；2合理分配agents用于不同计划，给出精要全面的agents工作配合计划。

## 腾讯文档智能监控系统 - 项目总览

🎯 **企业级智能文档变更监控与风险评估系统**

### 📋 系统架构概述

本系统是一个完整的企业级文档监控解决方案，包含10个主要处理步骤，支持5200+参数配置，实现从CSV对比分析到Excel半填充标记的完整链路。

### 🚀 核心功能模块

1. **📊 智能变更检测系统**
   - CSV格式表格对比分析
   - AI驱动的列名标准化
   - 自适应表格结构处理
   - 风险等级智能分类（L1/L2/L3）

2. **🔥 科学热力图可视化**
   - 30×19标准矩阵显示
   - 高斯平滑算法处理
   - 5级色彩分段映射（蓝→青→绿→黄→血红）
   - 实时统计和热点识别

3. **📝 专业Excel半填充标记**
   - lightUp图案对角线纹理
   - 企业级颜色编码
   - 详细AI分析批注
   - 自动上传腾讯文档

4. **🤖 Claude AI语义分析**
   - 变更合理性评估
   - 风险等级智能判断
   - 审批建议生成
   - 置信度评分

### 📊 完整处理流程

**步骤1-3**: CSV数据采集与初步对比
**步骤4**: AI列名标准化处理
**步骤5**: 数据清洗与重新打分
**步骤6**: 5200+参数UI数据生成
**步骤7**: 复杂热力图UI显示
**步骤8**: Excel MCP专业半填充
**步骤9**: 自动上传腾讯文档
**步骤10**: UI链接绑定与交互

### 🎯 核心技术特性
- **自适应列匹配**: 智能处理不同表格结构
- **数据清洗算法**: 标准化评分权重计算
- **热力图算法**: 高斯平滑+科学色彩映射
- **Excel MCP集成**: 专业文档标记
- **实时UI更新**: WebSocket实时数据同步

## 项目完成状态 (2025-08-13)

✅ **腾讯文档智能监控系统已全面完成**

### 🎯 核心成果
- 完整10步处理流程 - 全部实现并测试通过
- Claude封装程序 (端口8081) - 正常运行，API成功率88.9%
- 智能热力图UI (端口8089) - 完整功能，30×19矩阵显示
- Excel MCP半填充 - 专业标记，自动上传
- AI语义分析功能 - 100%测试通过，平均置信度0.85

### 📊 实际测试结果
**完整流程测试**: 10/10步骤全部通过 ✅  
**5200+参数处理**: 100%正确解析 ✅  
**热力图渲染**: 高斯平滑+科学色彩 ✅  
**Excel半填充**: lightUp纹理+AI批注 ✅  
**系统评级**: 企业级生产就绪 🏅

### 📁 完整文件清单
详见: `系统功能组件完整清单.md`

## 🔧 8089端口热力图UI服务配置 (2025-08-13)

### ⚠️ 访问问题解决方案
**问题症状**: http://192.140.176.198:8089/ 被nginx防火墙阻拦  
**解决方案**: 
```bash
sudo ufw allow 8089
```

### 🚀 正确启动服务器
**错误启动**: `python3 debug_ui_server.py` - 只显示加载页面  
**正确启动**: `python3 final_heatmap_server.py` - 完整功能UI

### 📊 服务器功能对比
| 服务器文件 | 功能 | 用途 |
|-----------|------|------|
| `debug_ui_server.py` | 测试页面 | React组件测试 |
| `final_heatmap_server.py` | 完整热力图UI | **生产使用** |
| `simple_ui_server.py` | 简化版UI | 基础功能测试 |

### 🔥 热力图UI特色功能
- ✅ 高斯平滑算法
- ✅ 科学热力图颜色映射  
- ✅ 智能数据排序
- ✅ 30×19完整矩阵
- ✅ 真实风险统计

## Excel MCP 使用规范

⚠️ **重要**: 在使用Excel MCP进行任何Excel文件操作前，必须先阅读以下使用指南：

📖 **完整使用指南**: [docs/Excel-MCP-AI-使用指南.md](docs/Excel-MCP-AI-使用指南.md)

### 快速参考

1. **推荐使用**: `mcp__excel-optimized__*` 函数（内存优化版）
2. **文件路径**: 必须使用绝对路径，如 `/root/projects/file.xlsx`
3. **内存限制**: 单次操作不超过2000单元格
4. **中文支持**: 直接使用中文工作表名和数据内容
5. **数据格式**: 写入时使用二维数组 `[[row1], [row2]]`

### 错误处理
- 文件不存在 → 检查绝对路径
- 内存超限 → 使用分页处理
- 格式错误 → 检查二维数组格式

# important-instruction-reminders
Do what has been asked; nothing more, nothing less.
NEVER create files unless they're absolutely necessary for achieving your goal.
ALWAYS prefer editing an existing file to creating a new one.
NEVER proactively create documentation files (*.md) or README files. Only create documentation files if explicitly requested by the User.

