<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIåˆ—åæ ‡å‡†åŒ–æµ‹è¯•å¹³å°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #333;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            color: #666;
            font-size: 1.1rem;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .card h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }
        
        .test-scenarios {
            display: grid;
            gap: 15px;
        }
        
        .scenario-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.2s;
            text-align: left;
        }
        
        .scenario-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .scenario-button .title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .scenario-button .description {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .input-section {
            margin-bottom: 20px;
        }
        
        .input-section label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }
        
        .input-section textarea {
            width: 100%;
            height: 200px;
            padding: 12px;
            border: 2px solid #e1e1e1;
            border-radius: 8px;
            font-family: monospace;
            font-size: 13px;
            resize: vertical;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: transform 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }
        
        .result-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .result-section h3 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .mapping-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .mapping-table th,
        .mapping-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #e1e1e1;
        }
        
        .mapping-table th {
            background: #f0f0f0;
            font-weight: 600;
        }
        
        .confidence-high {
            color: #28a745;
            font-weight: bold;
        }
        
        .confidence-medium {
            color: #ffc107;
            font-weight: bold;
        }
        
        .confidence-low {
            color: #dc3545;
            font-weight: bold;
        }
        
        .missing-column {
            background: #ffebee;
            color: #c62828;
        }
        
        .discarded-column {
            background: #fff3e0;
            color: #ef6c00;
        }
        
        .statistics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-card .value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-card .label {
            color: #666;
            font-size: 12px;
            margin-top: 5px;
        }
        
        .full-width {
            grid-column: span 2;
        }
        
        .json-viewer {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow: auto;
            white-space: pre-wrap;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e1e1e1;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background: none;
            color: #666;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .tab.active {
            color: #667eea;
            border-bottom: 2px solid #667eea;
            margin-bottom: -2px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¡µå¤´ -->
        <div class="header">
            <h1>ğŸ¤– AIåˆ—åæ ‡å‡†åŒ–æµ‹è¯•å¹³å°</h1>
            <div class="subtitle">æµ‹è¯•CSVå¯¹æ¯”ç»“æœçš„åˆ—åæ˜ å°„åˆ°19ä¸ªæ ‡å‡†åˆ—å - æ”¯æŒå¤šåˆ—/å°‘åˆ—/ç­‰åˆ—åœºæ™¯</div>
        </div>
        
        <!-- ä¸»ç½‘æ ¼ -->
        <div class="main-grid">
            <!-- å·¦ä¾§ï¼šæµ‹è¯•åœºæ™¯ -->
            <div class="card">
                <h2>ğŸ“‹ æµ‹è¯•åœºæ™¯</h2>
                <div class="test-scenarios">
                    <button class="scenario-button" onclick="loadScenario('less')">
                        <div class="title">åœºæ™¯1ï¼šåˆ—æ•°ä¸è¶³ï¼ˆå°‘äº19åˆ—ï¼‰</div>
                        <div class="description">æµ‹è¯•6åˆ—æ•°æ®ï¼Œè¯†åˆ«ç¼ºå¤±çš„13ä¸ªæ ‡å‡†åˆ—</div>
                    </button>
                    <button class="scenario-button" onclick="loadScenario('more')">
                        <div class="title">åœºæ™¯2ï¼šåˆ—æ•°è¿‡å¤šï¼ˆå¤šäº19åˆ—ï¼‰</div>
                        <div class="description">æµ‹è¯•25åˆ—æ•°æ®ï¼Œè¿‡æ»¤6ä¸ªæ— æ³•æ˜ å°„çš„åˆ—</div>
                    </button>
                    <button class="scenario-button" onclick="loadScenario('equal')">
                        <div class="title">åœºæ™¯3ï¼šåˆ—æ•°ç›¸ç­‰ï¼ˆæ­£å¥½19åˆ—ï¼‰</div>
                        <div class="description">æµ‹è¯•19åˆ—æ•°æ®ï¼Œä¸€å¯¹ä¸€æ˜ å°„</div>
                    </button>
                    <button class="scenario-button" onclick="loadScenario('variation')">
                        <div class="title">åœºæ™¯4ï¼šå˜å¼‚åˆ—åæµ‹è¯•</div>
                        <div class="description">æµ‹è¯•å¸¸è§å˜å¼‚å½¢å¼çš„è¯†åˆ«èƒ½åŠ›</div>
                    </button>
                    <button class="scenario-button" onclick="loadRealFile()">
                        <div class="title">åœºæ™¯5ï¼šçœŸå®CSVå¯¹æ¯”æ–‡ä»¶</div>
                        <div class="description">åŠ è½½é¡¹ç›®ä¸­çš„å®é™…å¯¹æ¯”ç»“æœæ–‡ä»¶</div>
                    </button>
                </div>
                
                <div class="input-section" style="margin-top: 20px;">
                    <label>è¾“å…¥åˆ—åï¼ˆJSONæ•°ç»„æ ¼å¼ï¼‰ï¼š</label>
                    <textarea id="inputColumns" placeholder='["ID", "äº§å“åç§°", "ä»·æ ¼", "åº“å­˜", "çŠ¶æ€", "æ›´æ–°æ—¶é—´"]'></textarea>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-success" onclick="standardizeColumns()">æ‰§è¡Œæ ‡å‡†åŒ–</button>
                    <button class="btn btn-warning" onclick="generatePrompt()">ç”Ÿæˆæç¤ºè¯</button>
                    <button class="btn btn-danger" onclick="clearAll()">æ¸…ç©º</button>
                </div>
            </div>
            
            <!-- å³ä¾§ï¼š19ä¸ªæ ‡å‡†åˆ—åå‚è€ƒ -->
            <div class="card">
                <h2>ğŸ“Š 19ä¸ªæ ‡å‡†åˆ—åï¼ˆç³»ç»Ÿå®šä¹‰ï¼‰</h2>
                <div class="mapping-table-container">
                    <table class="mapping-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>æ ‡å‡†åˆ—å</th>
                                <th>é£é™©ç­‰çº§</th>
                                <th>å¸¸è§å˜å¼‚</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>1</td><td>åºå·</td><td>L3</td><td>ID, ç¼–å·, NO</td></tr>
                            <tr><td>2</td><td>é¡¹ç›®ç±»å‹</td><td>L2</td><td>é¡¹ç›®ç±»åˆ«, ç±»å‹</td></tr>
                            <tr><td>3</td><td>æ¥æº</td><td>L1</td><td>æ•°æ®æ¥æº, ä¿¡æ¯æ¥æº</td></tr>
                            <tr><td>4</td><td>ä»»åŠ¡å‘èµ·æ—¶é—´</td><td>L1</td><td>å‘èµ·æ—¶é—´, å¼€å§‹æ—¶é—´</td></tr>
                            <tr><td>5</td><td>ç›®æ ‡å¯¹é½</td><td>L1</td><td>ç›®æ ‡, ä¸šåŠ¡ç›®æ ‡</td></tr>
                            <tr><td>6</td><td>å…³é”®KRå¯¹é½</td><td>L1</td><td>KR, å…³é”®ç»“æœ</td></tr>
                            <tr><td>7</td><td>å…·ä½“è®¡åˆ’å†…å®¹</td><td>L2</td><td>è®¡åˆ’å†…å®¹, å†…å®¹</td></tr>
                            <tr><td>8</td><td>é‚“æ€»æŒ‡å¯¼ç™»è®°</td><td>L2</td><td>é‚“æ€»æŒ‡å¯¼, é¢†å¯¼æŒ‡å¯¼</td></tr>
                            <tr><td>9</td><td>è´Ÿè´£äºº</td><td>L2</td><td>è´£ä»»äºº, æ‰§è¡Œäºº</td></tr>
                            <tr><td>10</td><td>ååŠ©äºº</td><td>L2</td><td>ååŠ©äººå‘˜, ååŒäºº</td></tr>
                            <tr><td>11</td><td>ç›‘ç£äºº</td><td>L2</td><td>ç›‘ç£äººå‘˜, ç›‘ç®¡äºº</td></tr>
                            <tr><td>12</td><td>é‡è¦ç¨‹åº¦</td><td>L1</td><td>é‡è¦æ€§, ä¼˜å…ˆçº§</td></tr>
                            <tr><td>13</td><td>é¢„è®¡å®Œæˆæ—¶é—´</td><td>L1</td><td>å®Œæˆæ—¶é—´, deadline</td></tr>
                            <tr><td>14</td><td>å®Œæˆè¿›åº¦</td><td>L1</td><td>è¿›åº¦, å®Œæˆåº¦</td></tr>
                            <tr><td>15</td><td>å½¢æˆè®¡åˆ’æ¸…å•</td><td>L2</td><td>è®¡åˆ’æ¸…å•, æ¸…å•</td></tr>
                            <tr><td>16</td><td>å¤ç›˜æ—¶é—´</td><td>L3</td><td>å¤ç›˜æ—¥æœŸ, å›é¡¾æ—¶é—´</td></tr>
                            <tr><td>17</td><td>å¯¹ä¸Šæ±‡æŠ¥</td><td>L3</td><td>æ±‡æŠ¥, ä¸ŠæŠ¥</td></tr>
                            <tr><td>18</td><td>åº”ç”¨æƒ…å†µ</td><td>L3</td><td>åº”ç”¨, ä½¿ç”¨æƒ…å†µ</td></tr>
                            <tr><td>19</td><td>è¿›åº¦åˆ†ææ€»ç»“</td><td>L3</td><td>è¿›åº¦åˆ†æ, æ€»ç»“</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div class="card" id="statisticsCard" style="display: none;">
            <h2>ğŸ“ˆ æ˜ å°„ç»Ÿè®¡</h2>
            <div class="statistics">
                <div class="stat-card">
                    <div class="value" id="totalColumns">0</div>
                    <div class="label">è¾“å…¥åˆ—æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="value" id="mappedColumns">0</div>
                    <div class="label">æˆåŠŸæ˜ å°„</div>
                </div>
                <div class="stat-card">
                    <div class="value" id="missingColumns">0</div>
                    <div class="label">ç¼ºå¤±åˆ—æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="value" id="discardedColumns">0</div>
                    <div class="label">ä¸¢å¼ƒåˆ—æ•°</div>
                </div>
            </div>
        </div>
        
        <!-- ç»“æœå±•ç¤º -->
        <div class="card full-width" id="resultCard" style="display: none;">
            <h2>ğŸ¯ æ ‡å‡†åŒ–ç»“æœ</h2>
            
            <!-- æ ‡ç­¾é¡µ -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('mapping')">æ˜ å°„å…³ç³»</button>
                <button class="tab" onclick="switchTab('missing')">ç¼ºå¤±åˆ—</button>
                <button class="tab" onclick="switchTab('discarded')">ä¸¢å¼ƒåˆ—</button>
                <button class="tab" onclick="switchTab('output')">19åˆ—è¾“å‡º</button>
                <button class="tab" onclick="switchTab('prompt')">ç”Ÿæˆçš„æç¤ºè¯</button>
                <button class="tab" onclick="switchTab('json')">JSONç»“æœ</button>
            </div>
            
            <!-- æ˜ å°„å…³ç³» -->
            <div class="tab-content active" id="mappingTab">
                <div class="result-section">
                    <h3>åˆ—åæ˜ å°„å…³ç³»</h3>
                    <table class="mapping-table" id="mappingTable">
                        <thead>
                            <tr>
                                <th>å®é™…åˆ—å</th>
                                <th>â†’</th>
                                <th>æ ‡å‡†åˆ—å</th>
                                <th>ç½®ä¿¡åº¦</th>
                                <th>åŒ¹é…ç±»å‹</th>
                            </tr>
                        </thead>
                        <tbody id="mappingTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ç¼ºå¤±åˆ— -->
            <div class="tab-content" id="missingTab">
                <div class="result-section">
                    <h3>ç¼ºå¤±çš„æ ‡å‡†åˆ—ï¼ˆå°†åœ¨è¾“å‡ºä¸­æ ‡è®°ä¸ºnullï¼‰</h3>
                    <div id="missingList"></div>
                </div>
            </div>
            
            <!-- ä¸¢å¼ƒåˆ— -->
            <div class="tab-content" id="discardedTab">
                <div class="result-section">
                    <h3>è¢«ä¸¢å¼ƒçš„å®é™…åˆ—ï¼ˆæ— æ³•æ˜ å°„åˆ°æ ‡å‡†åˆ—ï¼‰</h3>
                    <div id="discardedList"></div>
                </div>
            </div>
            
            <!-- 19åˆ—è¾“å‡º -->
            <div class="tab-content" id="outputTab">
                <div class="result-section">
                    <h3>æ ‡å‡†åŒ–19åˆ—è¾“å‡ºé¢„è§ˆ</h3>
                    <table class="mapping-table" id="outputTable">
                        <thead>
                            <tr id="outputTableHeader"></tr>
                        </thead>
                        <tbody id="outputTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- æç¤ºè¯ -->
            <div class="tab-content" id="promptTab">
                <div class="result-section">
                    <h3>ç”Ÿæˆçš„AIæç¤ºè¯</h3>
                    <div class="json-viewer" id="promptContent"></div>
                </div>
            </div>
            
            <!-- JSONç»“æœ -->
            <div class="tab-content" id="jsonTab">
                <div class="result-section">
                    <h3>å®Œæ•´JSONå“åº”</h3>
                    <div class="json-viewer" id="jsonContent"></div>
                </div>
            </div>
            
            <!-- åŠ è½½åŠ¨ç”» -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p style="margin-top: 20px; color: #666;">æ­£åœ¨å¤„ç†...</p>
            </div>
        </div>
    </div>
    
    <script>
        // 19ä¸ªæ ‡å‡†åˆ—å
        const STANDARD_COLUMNS = [
            "åºå·", "é¡¹ç›®ç±»å‹", "æ¥æº", "ä»»åŠ¡å‘èµ·æ—¶é—´", "ç›®æ ‡å¯¹é½",
            "å…³é”®KRå¯¹é½", "å…·ä½“è®¡åˆ’å†…å®¹", "é‚“æ€»æŒ‡å¯¼ç™»è®°", "è´Ÿè´£äºº",
            "ååŠ©äºº", "ç›‘ç£äºº", "é‡è¦ç¨‹åº¦", "é¢„è®¡å®Œæˆæ—¶é—´", "å®Œæˆè¿›åº¦", 
            "å½¢æˆè®¡åˆ’æ¸…å•", "å¤ç›˜æ—¶é—´", "å¯¹ä¸Šæ±‡æŠ¥", "åº”ç”¨æƒ…å†µ", "è¿›åº¦åˆ†ææ€»ç»“"
        ];
        
        // å˜å¼‚æ¨¡å¼åº“
        const VARIATION_PATTERNS = {
            "åºå·": ["åºåˆ—å·", "ç¼–å·", "ID", "ç´¢å¼•", "NO", "No.", "è¡Œå·"],
            "é¡¹ç›®ç±»å‹": ["é¡¹ç›®ç±»åˆ«", "é¡¹ç›®åˆ†ç±»", "ç±»å‹", "ç±»åˆ«", "é¡¹ç›®ç§ç±»"],
            "æ¥æº": ["æ•°æ®æ¥æº", "ä¿¡æ¯æ¥æº", "æ¥æºæ¸ é“", "æºå¤´"],
            "ä»»åŠ¡å‘èµ·æ—¶é—´": ["å‘èµ·æ—¶é—´", "ä»»åŠ¡æ—¶é—´", "å¼€å§‹æ—¶é—´", "åˆ›å»ºæ—¶é—´", "å‘èµ·æ—¥æœŸ"],
            "ç›®æ ‡å¯¹é½": ["ç›®æ ‡", "å¯¹é½ç›®æ ‡", "ä¸šåŠ¡ç›®æ ‡", "æˆ˜ç•¥å¯¹é½"],
            "å…³é”®KRå¯¹é½": ["KR", "å…³é”®ç»“æœ", "KRå¯¹é½", "å…³é”®æŒ‡æ ‡"],
            "å…·ä½“è®¡åˆ’å†…å®¹": ["è®¡åˆ’å†…å®¹", "è®¡åˆ’", "å†…å®¹", "å…·ä½“å†…å®¹", "ä»»åŠ¡å†…å®¹", "å·¥ä½œå†…å®¹"],
            "é‚“æ€»æŒ‡å¯¼ç™»è®°": ["é‚“æ€»æŒ‡å¯¼", "é¢†å¯¼æŒ‡å¯¼", "æŒ‡å¯¼ç™»è®°", "ä¸Šçº§æŒ‡å¯¼"],
            "è´Ÿè´£äºº": ["è´£ä»»äºº", "ä¸»è´Ÿè´£äºº", "è´Ÿè´£äººå‘˜", "æ‰§è¡Œäºº"],
            "ååŠ©äºº": ["ååŠ©äººå‘˜", "ååŒäºº", "é…åˆäºº", "åŠ©ç†"],
            "ç›‘ç£äºº": ["ç›‘ç£äººå‘˜", "ç›‘ç®¡äºº", "ç£å¯¼äºº", "æ£€æŸ¥äºº"],
            "é‡è¦ç¨‹åº¦": ["é‡è¦æ€§", "ä¼˜å…ˆçº§", "é‡è¦ç­‰çº§", "ç´§æ€¥ç¨‹åº¦"],
            "é¢„è®¡å®Œæˆæ—¶é—´": ["å®Œæˆæ—¶é—´", "æˆªæ­¢æ—¶é—´", "é¢„è®¡æ—¶é—´", "ç»“æŸæ—¶é—´", "deadline"],
            "å®Œæˆè¿›åº¦": ["è¿›åº¦", "å®Œæˆåº¦", "è¿›å±•", "å®Œæˆç™¾åˆ†æ¯”", "è¿›åº¦ç™¾åˆ†æ¯”"],
            "å½¢æˆè®¡åˆ’æ¸…å•": ["è®¡åˆ’æ¸…å•", "æ¸…å•", "ä»»åŠ¡æ¸…å•", "å·¥ä½œæ¸…å•"],
            "å¤ç›˜æ—¶é—´": ["å¤ç›˜æ—¥æœŸ", "å›é¡¾æ—¶é—´", "æ€»ç»“æ—¶é—´", "è¯„å®¡æ—¶é—´"],
            "å¯¹ä¸Šæ±‡æŠ¥": ["æ±‡æŠ¥", "å‘ä¸Šæ±‡æŠ¥", "ä¸ŠæŠ¥", "æŠ¥å‘Š"],
            "åº”ç”¨æƒ…å†µ": ["åº”ç”¨", "ä½¿ç”¨æƒ…å†µ", "å®æ–½æƒ…å†µ", "æ‰§è¡Œæƒ…å†µ"],
            "è¿›åº¦åˆ†ææ€»ç»“": ["è¿›åº¦åˆ†æ", "æ€»ç»“", "åˆ†ææ€»ç»“", "è¿›å±•æ€»ç»“", "æƒ…å†µæ€»ç»“"]
        };
        
        // åŠ è½½æµ‹è¯•åœºæ™¯
        function loadScenario(type) {
            let columns = [];
            
            switch(type) {
                case 'less':
                    // å°‘äº19åˆ—ï¼ˆ6åˆ—ï¼‰
                    columns = ["ID", "äº§å“åç§°", "ä»·æ ¼", "åº“å­˜", "çŠ¶æ€", "æ›´æ–°æ—¶é—´"];
                    break;
                    
                case 'more':
                    // å¤šäº19åˆ—ï¼ˆ25åˆ—ï¼‰
                    columns = [
                        "åºåˆ—å·", "é¡¹ç›®ç±»åˆ«", "æ•°æ®æ¥æº", "å‘èµ·æ—¶é—´", "ç›®æ ‡",
                        "KR", "è®¡åˆ’å†…å®¹", "é¢†å¯¼æŒ‡å¯¼", "è´£ä»»äºº", "ååŒäºº",
                        "ç›‘ç®¡äºº", "ä¼˜å…ˆçº§", "å®Œæˆæ—¶é—´", "è¿›åº¦", "æ¸…å•",
                        "å¤ç›˜æ—¥æœŸ", "æ±‡æŠ¥", "ä½¿ç”¨æƒ…å†µ", "æ€»ç»“",
                        "é¢å¤–å­—æ®µ1", "æµ‹è¯•åˆ—1", "ä¸´æ—¶æ•°æ®", "æ— å…³åˆ—1", "å¤‡ç”¨å­—æ®µ", "æ‰©å±•ä¿¡æ¯"
                    ];
                    break;
                    
                case 'equal':
                    // æ­£å¥½19åˆ—
                    columns = [
                        "ç¼–å·", "é¡¹ç›®åˆ†ç±»", "ä¿¡æ¯æ¥æº", "ä»»åŠ¡æ—¶é—´", "ä¸šåŠ¡ç›®æ ‡",
                        "å…³é”®ç»“æœ", "å…·ä½“å†…å®¹", "é‚“æ€»æŒ‡å¯¼", "æ‰§è¡Œäºº", "é…åˆäºº",
                        "ç£å¯¼äºº", "é‡è¦æ€§", "æˆªæ­¢æ—¶é—´", "å®Œæˆåº¦", "ä»»åŠ¡æ¸…å•",
                        "å›é¡¾æ—¶é—´", "ä¸ŠæŠ¥", "å®æ–½æƒ…å†µ", "è¿›å±•æ€»ç»“"
                    ];
                    break;
                    
                case 'variation':
                    // å˜å¼‚æµ‹è¯•
                    columns = [
                        "NO", "ç±»å‹", "æºå¤´", "å¼€å§‹æ—¶é—´", "æˆ˜ç•¥å¯¹é½",
                        "å…³é”®æŒ‡æ ‡", "å·¥ä½œå†…å®¹", "ä¸Šçº§æŒ‡å¯¼"
                    ];
                    break;
            }
            
            document.getElementById('inputColumns').value = JSON.stringify(columns, null, 2);
        }
        
        // åŠ è½½çœŸå®æ–‡ä»¶
        async function loadRealFile() {
            // æ¨¡æ‹ŸåŠ è½½é¡¹ç›®ä¸­çš„çœŸå®CSVå¯¹æ¯”ç»“æœ
            const realColumns = [
                "ID", "äº§å“åç§°", "ä»·æ ¼", "åº“å­˜", "çŠ¶æ€", "æ›´æ–°æ—¶é—´"
            ];
            
            document.getElementById('inputColumns').value = JSON.stringify(realColumns, null, 2);
            alert('å·²åŠ è½½çœŸå®CSVå¯¹æ¯”æ–‡ä»¶çš„åˆ—å');
        }
        
        // æ‰§è¡Œæ ‡å‡†åŒ–
        function standardizeColumns() {
            const inputText = document.getElementById('inputColumns').value;
            
            if (!inputText) {
                alert('è¯·è¾“å…¥åˆ—åæ•°ç»„');
                return;
            }
            
            try {
                const actualColumns = JSON.parse(inputText);
                
                if (!Array.isArray(actualColumns)) {
                    alert('è¾“å…¥å¿…é¡»æ˜¯JSONæ•°ç»„æ ¼å¼');
                    return;
                }
                
                // æ‰§è¡Œæ˜ å°„
                const result = performStandardization(actualColumns);
                
                // æ˜¾ç¤ºç»“æœ
                displayResult(result);
                
            } catch (e) {
                alert('JSONæ ¼å¼é”™è¯¯: ' + e.message);
            }
        }
        
        // æ‰§è¡Œæ ‡å‡†åŒ–æ˜ å°„ï¼ˆæ¨¡æ‹ŸAIå“åº”ï¼‰
        function performStandardization(actualColumns) {
            const result = {
                success: true,
                standard_columns_status: {},
                mapping: {},
                confidence_scores: {},
                missing_standard_columns: [],
                discarded_columns: [],
                statistics: {
                    total_standard: 19,
                    mapped_count: 0,
                    missing_count: 0,
                    discarded_count: 0
                }
            };
            
            // åˆå§‹åŒ–æ‰€æœ‰æ ‡å‡†åˆ—ä¸ºnull
            STANDARD_COLUMNS.forEach(col => {
                result.standard_columns_status[col] = null;
            });
            
            // å¤„ç†æ¯ä¸ªå®é™…åˆ—
            const mappedStandards = new Set();
            
            actualColumns.forEach(actualCol => {
                let bestMatch = null;
                let bestScore = 0;
                let matchType = 'none';
                
                // 1. æ£€æŸ¥ç²¾ç¡®åŒ¹é…
                if (STANDARD_COLUMNS.includes(actualCol)) {
                    bestMatch = actualCol;
                    bestScore = 1.0;
                    matchType = 'exact';
                } else {
                    // 2. æ£€æŸ¥å˜å¼‚åŒ¹é…
                    for (const [standard, variations] of Object.entries(VARIATION_PATTERNS)) {
                        if (variations.includes(actualCol)) {
                            if (!mappedStandards.has(standard)) {
                                bestMatch = standard;
                                bestScore = 0.9;
                                matchType = 'variation';
                                break;
                            }
                        }
                    }
                    
                    // 3. è¯­ä¹‰åŒ¹é…ï¼ˆç®€å•æ¨¡æ‹Ÿï¼‰
                    if (!bestMatch) {
                        for (const standard of STANDARD_COLUMNS) {
                            if (!mappedStandards.has(standard)) {
                                // ç®€å•çš„åŒ…å«å…³ç³»æ£€æŸ¥
                                if (actualCol.includes(standard.substring(0, 2)) || 
                                    standard.includes(actualCol.substring(0, 2))) {
                                    bestMatch = standard;
                                    bestScore = 0.6;
                                    matchType = 'semantic';
                                    break;
                                }
                            }
                        }
                    }
                }
                
                if (bestMatch && !mappedStandards.has(bestMatch)) {
                    result.mapping[actualCol] = bestMatch;
                    result.confidence_scores[actualCol] = bestScore;
                    result.standard_columns_status[bestMatch] = actualCol;
                    mappedStandards.add(bestMatch);
                    result.statistics.mapped_count++;
                } else {
                    result.discarded_columns.push(actualCol);
                    result.statistics.discarded_count++;
                }
            });
            
            // è¯†åˆ«ç¼ºå¤±çš„æ ‡å‡†åˆ—
            STANDARD_COLUMNS.forEach(col => {
                if (result.standard_columns_status[col] === null) {
                    result.missing_standard_columns.push(col);
                    result.statistics.missing_count++;
                }
            });
            
            return result;
        }
        
        // æ˜¾ç¤ºç»“æœ
        function displayResult(result) {
            // æ˜¾ç¤ºå¡ç‰‡
            document.getElementById('statisticsCard').style.display = 'block';
            document.getElementById('resultCard').style.display = 'block';
            
            // æ›´æ–°ç»Ÿè®¡
            const inputColumns = JSON.parse(document.getElementById('inputColumns').value);
            document.getElementById('totalColumns').textContent = inputColumns.length;
            document.getElementById('mappedColumns').textContent = result.statistics.mapped_count;
            document.getElementById('missingColumns').textContent = result.statistics.missing_count;
            document.getElementById('discardedColumns').textContent = result.statistics.discarded_count;
            
            // æ˜¾ç¤ºæ˜ å°„è¡¨
            const tbody = document.getElementById('mappingTableBody');
            tbody.innerHTML = '';
            
            Object.entries(result.mapping).forEach(([actual, standard]) => {
                const confidence = result.confidence_scores[actual];
                const row = tbody.insertRow();
                
                row.innerHTML = `
                    <td>${actual}</td>
                    <td>â†’</td>
                    <td><strong>${standard}</strong></td>
                    <td class="${getConfidenceClass(confidence)}">${(confidence * 100).toFixed(0)}%</td>
                    <td>${getMatchType(confidence)}</td>
                `;
            });
            
            // æ˜¾ç¤ºç¼ºå¤±åˆ—
            const missingList = document.getElementById('missingList');
            if (result.missing_standard_columns.length > 0) {
                missingList.innerHTML = result.missing_standard_columns
                    .map(col => `<div class="missing-column" style="padding: 10px; margin: 5px; border-radius: 5px;">${col}</div>`)
                    .join('');
            } else {
                missingList.innerHTML = '<p style="color: #28a745;">âœ“ æ²¡æœ‰ç¼ºå¤±çš„æ ‡å‡†åˆ—</p>';
            }
            
            // æ˜¾ç¤ºä¸¢å¼ƒåˆ—
            const discardedList = document.getElementById('discardedList');
            if (result.discarded_columns.length > 0) {
                discardedList.innerHTML = result.discarded_columns
                    .map(col => `<div class="discarded-column" style="padding: 10px; margin: 5px; border-radius: 5px;">${col}</div>`)
                    .join('');
            } else {
                discardedList.innerHTML = '<p style="color: #28a745;">âœ“ æ²¡æœ‰è¢«ä¸¢å¼ƒçš„åˆ—</p>';
            }
            
            // æ˜¾ç¤º19åˆ—è¾“å‡º
            const outputHeader = document.getElementById('outputTableHeader');
            outputHeader.innerHTML = '<th>#</th>' + STANDARD_COLUMNS.map(col => `<th>${col}</th>`).join('');
            
            const outputBody = document.getElementById('outputTableBody');
            outputBody.innerHTML = '';
            const sampleRow = outputBody.insertRow();
            sampleRow.innerHTML = '<td>1</td>' + STANDARD_COLUMNS.map(col => {
                const actualCol = result.standard_columns_status[col];
                return actualCol ? `<td>æ•°æ®</td>` : `<td style="background: #ffebee; color: #c62828;">null</td>`;
            }).join('');
            
            // æ˜¾ç¤ºJSONç»“æœ
            document.getElementById('jsonContent').textContent = JSON.stringify(result, null, 2);
        }
        
        // è·å–ç½®ä¿¡åº¦æ ·å¼ç±»
        function getConfidenceClass(confidence) {
            if (confidence >= 0.8) return 'confidence-high';
            if (confidence >= 0.6) return 'confidence-medium';
            return 'confidence-low';
        }
        
        // è·å–åŒ¹é…ç±»å‹
        function getMatchType(confidence) {
            if (confidence === 1.0) return 'ç²¾ç¡®åŒ¹é…';
            if (confidence >= 0.8) return 'å˜å¼‚åŒ¹é…';
            if (confidence >= 0.6) return 'è¯­ä¹‰åŒ¹é…';
            return 'å¼ºåˆ¶åŒ¹é…';
        }
        
        // ç”Ÿæˆæç¤ºè¯
        function generatePrompt() {
            const inputText = document.getElementById('inputColumns').value;
            
            if (!inputText) {
                alert('è¯·è¾“å…¥åˆ—åæ•°ç»„');
                return;
            }
            
            try {
                const actualColumns = JSON.parse(inputText);
                const prompt = buildPrompt(actualColumns);
                
                document.getElementById('resultCard').style.display = 'block';
                switchTab('prompt');
                document.getElementById('promptContent').textContent = prompt;
                
            } catch (e) {
                alert('JSONæ ¼å¼é”™è¯¯: ' + e.message);
            }
        }
        
        // æ„å»ºæç¤ºè¯
        function buildPrompt(actualColumns) {
            const status = actualColumns.length < 19 ? 'åˆ—æ•°ä¸è¶³ï¼Œéœ€è¦è¯†åˆ«ç¼ºå¤±åˆ—' :
                          actualColumns.length > 19 ? 'åˆ—æ•°è¿‡å¤šï¼Œéœ€è¦è¿‡æ»¤æ— å…³åˆ—' : 'åˆ—æ•°åŒ¹é…';
            
            return `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åˆ—åæ ‡å‡†åŒ–ä¸“å®¶ã€‚ä½ çš„ä»»åŠ¡æ˜¯åˆ†æCSVè¡¨æ ¼åˆ—åï¼Œå¹¶ç”Ÿæˆå®Œæ•´çš„19åˆ—æ ‡å‡†åŒ–æ˜ å°„ç»“æœã€‚

## æ ¸å¿ƒä»»åŠ¡
1. å°†å®é™…åˆ—åæ˜ å°„åˆ°19ä¸ªæ ‡å‡†åˆ—å
2. è¯†åˆ«ç¼ºå¤±çš„æ ‡å‡†åˆ—ï¼ˆæ ‡è®°ä¸ºç©ºç™½ï¼‰
3. è¿‡æ»¤æ‰æ— æ³•æ˜ å°„çš„å¤šä½™åˆ—ï¼ˆä¸¢å¼ƒï¼‰
4. æœ€ç»ˆè¾“å‡ºå¿…é¡»åŒ…å«å…¨éƒ¨19ä¸ªæ ‡å‡†åˆ—çš„çŠ¶æ€

## 19ä¸ªæ ‡å‡†åˆ—åï¼ˆå›ºå®šé¡ºåºï¼Œå¿…é¡»å…¨éƒ¨è¾“å‡ºï¼‰
${JSON.stringify(STANDARD_COLUMNS, null, 2)}

## å®é™…åˆ—åï¼ˆå…±${actualColumns.length}ä¸ªï¼‰
${JSON.stringify(actualColumns, null, 2)}

## åˆ—æ•°æƒ…å†µåˆ†æ
- æ ‡å‡†åˆ—æ•°ï¼š19ä¸ª
- å®é™…åˆ—æ•°ï¼š${actualColumns.length}ä¸ª
- çŠ¶æ€ï¼š${status}

## è¾“å‡ºè¦æ±‚
{
    "success": true,
    "standard_columns_status": {
        // å…¨éƒ¨19ä¸ªæ ‡å‡†åˆ—çš„æ˜ å°„çŠ¶æ€
    },
    "mapping": {
        // æˆåŠŸæ˜ å°„çš„å®é™…åˆ—
    },
    "confidence_scores": {
        // æ¯ä¸ªæ˜ å°„çš„ç½®ä¿¡åº¦
    },
    "missing_standard_columns": [],
    "discarded_columns": [],
    "statistics": {
        "total_standard": 19,
        "mapped_count": æ˜ å°„æˆåŠŸæ•°,
        "missing_count": ç¼ºå¤±æ ‡å‡†åˆ—æ•°,
        "discarded_count": ä¸¢å¼ƒçš„å¤šä½™åˆ—æ•°
    }
}`;
        }
        
        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabName) {
            // ç§»é™¤æ‰€æœ‰activeç±»
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // æ·»åŠ activeç±»åˆ°é€‰ä¸­çš„æ ‡ç­¾
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }
        
        // æ¸…ç©ºæ‰€æœ‰
        function clearAll() {
            document.getElementById('inputColumns').value = '';
            document.getElementById('statisticsCard').style.display = 'none';
            document.getElementById('resultCard').style.display = 'none';
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.onload = function() {
            // åŠ è½½é»˜è®¤åœºæ™¯
            loadScenario('less');
        };
    </script>
</body>
</html>