# ğŸ¯ è…¾è®¯æ–‡æ¡£è‡ªåŠ¨åŒ– - å¿«é€Ÿå‚è€ƒå¡ç‰‡

## âœ… æˆåŠŸç™»å½•çš„5ä¸ªå…³é”®ç‚¹

### 1ï¸âƒ£ Cookieåˆ†å‰²å¿…é¡»æ­£ç¡®
```python
# âŒ é”™è¯¯
cookie_string.split(';')

# âœ… æ­£ç¡®
cookie_string.split('; ')  # æ³¨æ„ç©ºæ ¼ï¼
```

### 2ï¸âƒ£ CookieåŸŸè®¾ç½®
```python
# âŒ é”™è¯¯ - å¤šä¸ªåŸŸ
'domain': '.qq.com' å’Œ '.docs.qq.com'

# âœ… æ­£ç¡® - å•ä¸€åŸŸ
'domain': '.docs.qq.com'
```

### 3ï¸âƒ£ è®¿é—®æ­£ç¡®çš„é¡µé¢
```python
# âŒ é”™è¯¯
await page.goto('https://docs.qq.com/')

# âœ… æ­£ç¡®
await page.goto('https://docs.qq.com/desktop/')
```

### 4ï¸âƒ£ å……åˆ†ç­‰å¾…
```python
# âŒ é”™è¯¯
await page.wait_for_timeout(2000)

# âœ… æ­£ç¡®
await page.wait_for_timeout(5000)
```

### 5ï¸âƒ£ éªŒè¯ç™»å½•çŠ¶æ€
```python
# æˆåŠŸæ ‡å¿—
âœ… æ— ç™»å½•æŒ‰é’®
âœ… æœ‰å¯¼å…¥æŒ‰é’® (button.desktop-import-button-pc)
âœ… æœ‰ç”¨æˆ·ä¿¡æ¯
```

---

## ğŸ“¤ æˆåŠŸä¸Šä¼ çš„4ä¸ªæ­¥éª¤

### æ­¥éª¤1ï¼šç‚¹å‡»å¯¼å…¥æŒ‰é’®
```python
button = await page.wait_for_selector('button.desktop-import-button-pc')
await button.click()
```

### æ­¥éª¤2ï¼šé€‰æ‹©æ–‡ä»¶
```python
file_inputs = await page.query_selector_all('input[type="file"]')
await file_inputs[-1].set_input_files(file_path)
```

### æ­¥éª¤3ï¼šç¡®è®¤ä¸Šä¼ 
```python
confirm = await page.query_selector('button.dui-button-type-primary:has-text("ç¡®å®š")')
await confirm.click()
```

### æ­¥éª¤4ï¼šç­‰å¾…å®Œæˆ
```python
# URLå˜åŒ–è¡¨ç¤ºæˆåŠŸ
if '/sheet/' in page.url or '/doc/' in page.url:
    print("ä¸Šä¼ æˆåŠŸ")
```

---

## ğŸš€ æœ€ç®€ä»£ç ï¼ˆ30è¡Œï¼‰

```python
import asyncio
from playwright.async_api import async_playwright

async def upload(cookie_str, file_path):
    async with async_playwright() as p:
        # å¯åŠ¨
        browser = await p.chromium.launch(headless=False)
        context = await browser.new_context()
        page = await context.new_page()
        
        # Cookieå¤„ç†ï¼ˆå…³é”®ï¼ï¼‰
        cookies = []
        for pair in cookie_str.split('; '):  # æ³¨æ„ç©ºæ ¼
            if '=' in pair:
                name, value = pair.split('=', 1)
                cookies.append({
                    'name': name.strip(),
                    'value': value.strip(),
                    'domain': '.docs.qq.com',
                    'path': '/'
                })
        await context.add_cookies(cookies)
        
        # ç™»å½•
        await page.goto('https://docs.qq.com/desktop/')  # desktop!
        await page.wait_for_timeout(5000)  # 5ç§’ï¼
        
        # ä¸Šä¼ 
        btn = await page.wait_for_selector('button.desktop-import-button-pc')
        await btn.click()
        await page.wait_for_timeout(1000)
        
        inputs = await page.query_selector_all('input[type="file"]')
        await inputs[-1].set_input_files(file_path)
        
        await page.wait_for_timeout(2000)
        confirm = await page.query_selector('button:has-text("ç¡®å®š")')
        if confirm:
            await confirm.click()
        
        await page.wait_for_timeout(10000)
        success = '/sheet/' in page.url or '/doc/' in page.url
        
        await browser.close()
        return success
```

---

## ğŸ“‹ Cookieè·å–æ­¥éª¤

1. Chromeæ‰“å¼€ https://docs.qq.com
2. ç™»å½•è´¦å·
3. F12 â†’ Network
4. åˆ·æ–°é¡µé¢
5. æ‰¾ä»»æ„è¯·æ±‚ â†’ Headers â†’ Cookie
6. å¤åˆ¶å®Œæ•´å€¼

---

## âš ï¸ å¸¸è§é”™è¯¯å¯¹ç…§è¡¨

| ç—‡çŠ¶ | åŸå›  | è§£å†³ |
|-----|------|------|
| ç™»å½•å¤±è´¥ | Cookieåˆ†å‰²é”™è¯¯ | ä½¿ç”¨ `'; '` |
| é¡µé¢è¶…æ—¶ | è®¿é—®ä¸»é¡µè€Œédesktop | ç›´æ¥è®¿é—® `/desktop/` |
| æ‰¾ä¸åˆ°æŒ‰é’® | ç­‰å¾…æ—¶é—´ä¸è¶³ | ç­‰å¾…5ç§’ |
| æ–‡ä»¶é€‰æ‹©å¤±è´¥ | è·¯å¾„ä¸æ˜¯ç»å¯¹è·¯å¾„ | ä½¿ç”¨ `Path.resolve()` |
| ä¸Šä¼ æ— å“åº” | æœªç‚¹å‡»ç¡®å®š | æŸ¥æ‰¾ç¡®å®šæŒ‰é’®æˆ–æŒ‰Enter |

---

## ğŸ”‘ æ ¸å¿ƒåŸç†

```
æˆåŠŸ = æ­£ç¡®çš„Cookieå¤„ç† + æ­£ç¡®çš„é¡µé¢è®¿é—® + å……åˆ†çš„ç­‰å¾…
```

1. **Cookieå¤„ç†**ï¼šæµè§ˆå™¨æ ‡å‡†æ ¼å¼æ˜¯ `; ` åˆ†éš”
2. **é¡µé¢è®¿é—®**ï¼šdesktopæ˜¯å·²ç™»å½•ç”¨æˆ·çš„å…¥å£
3. **ç­‰å¾…ç­–ç•¥**ï¼šReact/Vueéœ€è¦æ—¶é—´æ¸²æŸ“

---

## ğŸ“ è°ƒè¯•æŠ€å·§

```python
# 1. ä½¿ç”¨å¯è§æ¨¡å¼
headless=False

# 2. æ‰“å°å…³é”®ä¿¡æ¯
print(f"Cookies: {len(cookies)}")
print(f"Title: {await page.title()}")
print(f"URL: {page.url}")

# 3. æˆªå›¾ä¿å­˜
await page.screenshot(path="debug.png")

# 4. ä¿æŒæµè§ˆå™¨æ‰“å¼€
await asyncio.sleep(30)
```

---

**è®°ä½æ ¸å¿ƒè¦ç‚¹**ï¼š
- Cookieç”¨ `'; '` åˆ†å‰²
- åªè®¾ç½® `.docs.qq.com` åŸŸ  
- ç›´æ¥è®¿é—® `/desktop/` é¡µé¢
- ç­‰å¾…5ç§’ç¡®ä¿åŠ è½½å®Œæˆ
- é€šè¿‡URLå˜åŒ–åˆ¤æ–­æˆåŠŸ