<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>çƒ­åŠ›å›¾é¢œè‰²ä¿®å¤æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .comparison { display: flex; gap: 40px; margin: 20px 0; }
        .column { flex: 1; }
        h2 { color: #333; margin-bottom: 10px; }
        .color-bar { height: 50px; display: flex; border: 2px solid #333; margin-bottom: 10px; }
        .segment { flex: 1; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8); }
        .test-values { margin-top: 20px; }
        .value-row { display: flex; align-items: center; margin: 10px 0; }
        .value-label { width: 100px; font-weight: bold; }
        .color-box { width: 100px; height: 40px; border: 2px solid #333; margin: 0 20px; }
        .color-text { font-family: monospace; }
    </style>
</head>
<body>
    <h1>ğŸ”¥ çƒ­åŠ›å›¾é¢œè‰²ä¿®å¤å¯¹æ¯”æµ‹è¯•</h1>

    <div class="comparison">
        <div class="column">
            <h2>âŒ æ—§ç‰ˆï¼ˆé—®é¢˜ï¼‰ï¼šé«˜å€¼å˜ç™½è‰²</h2>
            <div class="color-bar" id="oldBar"></div>
            <div class="test-values" id="oldValues"></div>
        </div>

        <div class="column">
            <h2>âœ… æ–°ç‰ˆï¼ˆå·²ä¿®å¤ï¼‰ï¼šé«˜å€¼æ˜¾ç¤ºæ·±çº¢</h2>
            <div class="color-bar" id="newBar"></div>
            <div class="test-values" id="newValues"></div>
        </div>
    </div>

    <script>
        // æ—§ç‰ˆé¢œè‰²å‡½æ•°ï¼ˆé«˜å€¼å˜ç™½ï¼‰
        const getThermalImageColorOld = (v) => {
            if (v <= 0.875) {
                // å…¶ä»–é¢œè‰²æ®µä¿æŒä¸å˜
                if (v <= 0.75) {
                    const t = (v - 0.625) / 0.125;
                    return {
                        r: Math.floor(150 + t * 105),
                        g: 255,
                        b: 0
                    };
                } else {
                    const t = (v - 0.75) / 0.125;
                    return {
                        r: 255,
                        g: Math.floor(255 - t * 100),
                        b: 0
                    };
                }
            } else {
                // æ—§ç‰ˆï¼šæ©™åˆ°çº¢åˆ°ç™½ (0.875-1.0)
                const t = (v - 0.875) / 0.125;
                return {
                    r: 255,
                    g: Math.floor(155 + t * 100),  // 155â†’255 ç™½è‰²
                    b: Math.floor(t * 255)         // 0â†’255 ç™½è‰²
                };
            }
        };

        // æ–°ç‰ˆé¢œè‰²å‡½æ•°ï¼ˆé«˜å€¼æ˜¾ç¤ºæ·±çº¢ï¼‰
        const getThermalImageColorNew = (v) => {
            if (v <= 0.875) {
                // å…¶ä»–é¢œè‰²æ®µä¿æŒä¸å˜
                if (v <= 0.75) {
                    const t = (v - 0.625) / 0.125;
                    return {
                        r: Math.floor(150 + t * 105),
                        g: 255,
                        b: 0
                    };
                } else {
                    const t = (v - 0.75) / 0.125;
                    return {
                        r: 255,
                        g: Math.floor(255 - t * 100),
                        b: 0
                    };
                }
            } else {
                // æ–°ç‰ˆï¼šæ©™åˆ°æ·±çº¢ (0.875-1.0)
                const t = (v - 0.875) / 0.125;
                return {
                    r: Math.floor(255 - t * 76),  // 255â†’179 æ·±çº¢
                    g: Math.floor(155 - t * 128), // 155â†’27 æ·±çº¢
                    b: Math.floor(0 + t * 27)     // 0â†’27 æ·±çº¢
                };
            }
        };

        // ç”Ÿæˆé¢œè‰²æ¡
        function createColorBar(elementId, colorFunc) {
            const bar = document.getElementById(elementId);
            for (let i = 0; i < 20; i++) {
                const value = i / 19;
                const color = colorFunc(value);
                const div = document.createElement('div');
                div.className = 'segment';
                div.style.background = `rgb(${color.r}, ${color.g}, ${color.b})`;
                if (value > 0.8) {
                    div.textContent = value.toFixed(2);
                }
                bar.appendChild(div);
            }
        }

        // æµ‹è¯•ç‰¹å®šå€¼
        function testValues(elementId, colorFunc, label) {
            const container = document.getElementById(elementId);
            const testVals = [0.8, 0.85, 0.9, 0.95, 1.0];

            testVals.forEach(val => {
                const color = colorFunc(val);
                const rgbStr = `rgb(${color.r}, ${color.g}, ${color.b})`;

                const row = document.createElement('div');
                row.className = 'value-row';
                row.innerHTML = `
                    <span class="value-label">å€¼ ${val}:</span>
                    <span class="color-box" style="background: ${rgbStr}"></span>
                    <span class="color-text">${rgbStr}</span>
                `;
                container.appendChild(row);
            });
        }

        // ç”Ÿæˆå¯¹æ¯”
        createColorBar('oldBar', getThermalImageColorOld);
        createColorBar('newBar', getThermalImageColorNew);

        testValues('oldValues', getThermalImageColorOld, 'æ—§ç‰ˆ');
        testValues('newValues', getThermalImageColorNew, 'æ–°ç‰ˆ');

        // æ·»åŠ è¯´æ˜
        const note = document.createElement('div');
        note.style.marginTop = '30px';
        note.style.padding = '20px';
        note.style.background = '#fff';
        note.style.border = '2px solid #333';
        note.innerHTML = `
            <h3>ğŸ“Š ä¿®å¤è¯´æ˜</h3>
            <ul>
                <li><strong>é—®é¢˜</strong>: é«˜é£é™©å€¼ï¼ˆ>0.875ï¼‰æ˜¾ç¤ºä¸ºç™½è‰² RGB(255,255,255)ï¼Œç¼ºä¹è­¦ç¤ºæ•ˆæœ</li>
                <li><strong>è§£å†³</strong>: ä¿®æ”¹getThermalImageColorå‡½æ•°ï¼Œè®©å€¼æ¥è¿‘1.0æ—¶æ˜¾ç¤ºæ·±çº¢è‰² RGB(179,27,27)</li>
                <li><strong>æ•ˆæœ</strong>: é«˜é£é™©åŒºåŸŸç°åœ¨æ˜¾ç¤ºä¸ºæ·±çº¢è‰²ï¼Œæä¾›æ›´å¼ºçš„è§†è§‰è­¦å‘Š</li>
                <li><strong>æ–‡ä»¶</strong>: final_heatmap_server.py ç¬¬5873-5881è¡Œ</li>
            </ul>
        `;
        document.body.appendChild(note);
    </script>
</body>
</html>